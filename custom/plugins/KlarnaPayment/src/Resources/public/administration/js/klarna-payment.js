/*! For license information please see klarna-payment.js.LICENSE.txt */
!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/bundles/klarnapayment/",n(n.s="gBKS")}({"0Uoz":function(e,t,n){},"0wRg":function(e,t){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==n(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!==n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===n(o)?o:String(o)),r)}var i,o}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=l(e);if(t){var r=l(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return s(this,n)}}function s(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var c=Shopware.Application,u=Shopware.Classes.ApiService,d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(c,e);var t,n,s,l=o(c);function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"klarna_payment";return a(this,c),l.call(this,e,t,n)}return t=c,(n=[{key:"finalizeInstallation",value:function(e){return this.httpClient.post("_action/".concat(this.getApiBasePath(),"/finalize_installation"),{tableData:JSON.stringify(e)},{headers:this.getBasicHeaders()}).then((function(e){return u.handleResponse(e)}))}},{key:"fetchData",value:function(){return this.httpClient.get("_action/".concat(this.getApiBasePath(),"/fetch_data"),{headers:this.getBasicHeaders()}).then((function(e){return u.handleResponse(e)}))}}])&&r(t.prototype,n),s&&r(t,s),Object.defineProperty(t,"prototype",{writable:!1}),c}(u);c.addServiceProvider("KlarnaPaymentWizardService",(function(e){var t=c.getContainer("init");return new d(t.httpClient,e.loginService)}))},"1KBz":function(e,t,n){var a=n("Mf2p");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n("SZ7m").default)("7b099d6d",a,!0,{})},"4yaB":function(e,t,n){},"9vXG":function(e,t,n){},BKmF:function(e){e.exports=JSON.parse('{"klarna-payment-configuration":{"module":{"title":"Klarna.","description":"Klarna."},"settingsForm":{"title":"Klarna","inheritanceWarning":"The display of inheritance for plugin configuration has been optimized with Shopware 6.3.4.0. Please update your system if you want to use inheritance safely.","apiConfiguration":{"notice":"Please note that the test and debug mode can\'t be configured individually per region as the corresponding endpoint is selected based on the billing address."},"globalPurchaseMissingInfo":"Pay Now, Pay Later and Financing will be combined into one payment method: Pay with Klarna. Every Klarna customer will soon be automatically migrated to this Global Purchase Flow. The status of your migration will be checked every time a customer accesses the order-confirmation page. This message will disappear once you have been migrated.","deprecatedConfiguration":"Pay Now, Pay Later and Financing are now combined into one payment method: Pay with Klarna. This configuration is not needed anymore and will be removed in a future version.","messages":{"titleSuccess":"Success","titleError":"Error","messageTestEUSuccess":"The API credentials for Europe were successfully validated.","messageTestUSSuccess":"The API credentials for North America were successfully validated.","messageTestEUErrorLive":"The API credentials for Europe could not be validated.","messageTestEUErrorTest":"The test mode API credentials for Europe could not be validated.","messageTestUSErrorLive":"The API credentials for North America could not be validated.","messageTestUSErrorTest":"The test mode API credentials for North America could not be validated.","messageSaveSuccess":"The plugin settings have been saved.","messageSaveError":"The plugin settings could not be saved.","messageMissingApiUsername":"No value has been provided for field \\"API Username\\" related to the active mode!","messageMissingApiPassword":"No value has been provided for field \\"API Password\\" related to the active mode!"},"buttons":{"save":"Save settings","test":"Test API credentials","wizard":"Start Wizard"},"onsiteMessaging":{"generate":"Generate your data here","playgroundUrl":"https://playground.eu.portal.klarna.com/on-site-messaging/#realm=merchants","defaultUrl":"https://eu.portal.klarna.com/on-site-messaging/#realm=merchants"},"klarnaPayments":{"payLater":{"description":"The option to pay later makes buying quicker and easier for customers: no need to fill out lengthy personal details or card number online.","title":"Pay Later"},"sliceIt":{"description":"Your customers can spread the cost of their purchases at a low interest rate, giving them flexibility and increased purchasing power. Our unique credit application requires minimal information and takes just seconds to complete.","title":"Financing"},"payNow":{"additional":"To use \\"Pay Now\\", you have to assign the payment methods \\"Pay Now\\", \\"Credit Card\\", \\"Direct Debit\\" and \\"Online Bank Transfer\\" to your sales channels.","description":"Customers who want to pay in full at checkout can do it quickly and securely with Klarna\'s Pay Now-option - using credit/debit card or direct bank transfer: Klarna Direkt, Sofort, SEPA Direct Debit.","title":"Pay Now"}}},"wizard":{"title":"Wizard","klarnaProduct":"Used Klarna product","steps":{"welcome":"Welcome","salesChannel":"Sales channel","documentation":"Documentation"},"content":{"welcome":{"customer":"Are you already a Klarna merchant? Please click Next.","registration":"If you have not yet registered with Klarna, please send an email to&nbsp;<a href=\'mailto:vertrieb@klarna.com\'>vertrieb@klarna.com</a>.","installation":"For setup and handling of the Klarna plugin you can find the installation guide&nbsp;<a target=\'_blank\' href=\'https://bit.ly/klarna-shopware-6-installationguide-en\'>HERE</a>."},"documentation":{"headline":"Thank you. The configuration of Klarna is completed.","introduction":"Klarna Payments are standalone payment methods. With Klarna Payments you can complement your checkout with a Klarna hosted widget located in your existing checkout. We support your online business to offer a wide range of payment options.","conclusion":"To learn more about Klarna, please click&nbsp;<a target=\'_blank\' href=\'https://bit.ly/klarna-shopware-6-installationguide-en\'>HERE</a>."}},"type":{"deactivated":"Deactivated","payments":"Klarna Payments","checkout":"Klarna Checkout"},"action":{"back":"Back","next":"Next","finish":"Finish"},"messages":{"titleSuccess":"Success","titleError":"Error","messageLoadError":"The wizard couldn\'t be loaded.","messageSaveSuccess":"Initial setup completed successfully.","messageSaveError":"The initial setup could not be completed successfully."}}}}')},Eqvc:function(e){e.exports=JSON.parse('{"klarna-payment-order-management":{"order-details":{"title":"Bestelldetails","orderNumber":"Shopware Bestellnummer","orderAmount":"Gesamtbetrag","capturedAmount":"Erfasster Betrag","refundedAmount":"Erstatteter Betrag","remainingAmount":"Verbleibender autorisierter Betrag","remainingAmountHelpText":"Der verbleibende autorisierte Betrag kann bei Bedarf erfasst werden.","klarnaOrderId":"Klarna Order-ID","klarnaReference":"Klarna Referenz","klarnaStatus":"Klarna Auftragsstatus","initialPaymentMethod":"Ursprüngliche Zahlart","riskCheck":"Klarna Betrugsstatus","riskCheckHelpText":"Nur Transaktionen im Status ACCEPTED können erfasst werden.","expiryDate":"Läuft ab am","expiryDateHelpText":"Wird das Ablaufdatum überschritten, ist keine weitere Aktion auf der Transaktion möglich."},"order-tab":{"title":"Klarna."},"modal":{"columns":{"reference":"Produktnummer","product":"Artikel","amount":"Menge","price":"Preis"}},"tooltips":{"transactionCancelled":"Die Transaktion wurde abgebrochen.","captureImpossible":"Eine Erfassung kann nur durchgeführt werden, wenn die Risikoprüfung erfolgreich war und ein autorisierter Betrag verfügbar ist.","refundImpossible":"Eine Rückerstattung kann nur durchgeführt werden, wenn ein Betrag vorher erfasst wurde.","extendAuthorizationImpossible":"Die Autorisierung ist bereits abgelaufen oder erfasst und kann deshalb nicht verlängert werden.","releaseAmountImpossible":"Es ist kein autorisierter Betrag mehr vorhanden oder bereits der gesamte Betrag erfasst.","cancellationImpossible":"Die Zahlung kann nur storniert werden, solange noch kein Betrag erfasst wurde."},"captureModal":{"title":"Betrag erfassen","submit":"Betrag erfassen","close":"Abbrechen","labelComment":"Kommentar","orderAmount":"Gesamter autorisierter Betrag","capturedAmount":"Schon erfasster Betrag","remainingAmount":"Verbleibender autorisierter Betrag","captureAmount":"Betrag erfassen","descriptionHelpText":"Der Kommentar ist aktuell nicht im Klarna Merchant Portal sichtbar."},"refundModal":{"title":"Betrag rückerstatten","submit":"Betrag rückerstatten","close":"Abbrechen","labelComment":"Kommentar","orderAmount":"Gesamter autorisierter Betrag","refundedAmount":"Schon rückerstatter Betrag","remainingAmount":"Verbleibender autorisierter Betrag","refundAmount":"Betrag rückerstatten","descriptionHelpText":"Der Kommentar ist aktuell nicht im Klarna Merchant Portal sichtbar."},"detailModal":{"title":"Details"},"authorizationModal":{"title":"Autorisierung verlängern","content":"Möchten Sie wirklich die Autorisierung verlängern?","submit":"Ja, verlängern","close":"Abbrechen"},"transactionHistory":{"title":"Bestellhistorie","columns":{"status":"Status","date":"Zeitpunkt","message":"Meldung"},"messages":{"CancelOrder":"Bestellung storniert","CancelPayment":"Zahlung storniert","GetOrder":"Bestellung abgerufen","CreateCapture":"Betrag erfasst","CreateOrder":"Bestellung erstellt","CreateRefund":"Betrag erstattet","ExtendAuthorization":"Autorisierung verlängert","Fallback":"Unbekannte Abfrage","ReleaseRemainingAuthorization":"Restbetrag freigegeben","UpdateAddress":"Adresse geändert","UpdateOrder":"Bestellung geändert"},"modal":{"typeColumn":"Betrag","valueColumn":"Wert","noAmount":"Keine weiteren Informationen","httpStatus":"HTTP-Statuscode:","type":{"total":"Gesamtbetrag der Transaktion","captured":"Erfasster Betrag in dieser Aktion","refunded":"Erstatteter Betrag in dieser Aktion"},"klarnaOrderId":"Klarna Bestell Id:","klarnaErrorCode":"Klarna Fehler Code:","klarnaErrorMessages":"Klarna Fehler Meldungen:","klarnaCorrelationId":"Klarna Korrelations Id:","ResponseButton":{"Shown":"Response verstecken","NotShown":"Response anzeigen"},"RequestButton":{"Shown":"Request verstecken","NotShown":"Request anzeigen"}}},"cancellation":{"messages":{"successTitle":"Erfolg","successMessage":"Die Zahlung wurde erfolgreich storniert.","failureTitle":"Fehler","failureMessage":"Die Zahlung konnte nicht storniert werden."},"modalButton":"Zahlung stornieren","modal":{"title":"Zahlungsstornierung","content":"Wollen Sie die Zahlung wirklich stornieren?","submit":"Ja, stornieren","close":"Abbrechen"}},"buttons":{"captureAmount":"Betrag erfassen","refundAmount":"Betrag rückerstatten","cancelOrder":"Bestellung stornieren","extendAuthorization":"Autorisierung verlängern","releaseAmount":"Betrag freigeben","showDetails":"Details"},"release":{"messages":{"successTitle":"Erfolg","successMessage":"Der verbleibende Betrag wurde freigegeben.","failureTitle":"Fehler","failureMessage":"Der verbleibende Betrag konnte nicht freigegeben werden."},"modal":{"title":"Verbleibenden Autorisierungsbetrag freigeben","content":"Möchten Sie wirklich den verbleibenden Autorisierungsbetrag freigeben?","submit":"Ja, freigeben","close":"Abbrechen"}},"messages":{"authorizationModal":{"extendSuccessTitle":"Erfolg","extendSuccessMessage":"Die Klarna Autorisierung wurde erfolgreich verlängert.","extendErrorTitle":"Fehler","extendErrorMessage":"Die Klarna Autorisierung konnte nicht erfolgreich verlängert werden."},"loadErrorTitle":"Fehler","loadErrorMessage":"Die Klarna Auftragsdetails konnten nicht geladen werden.","captureErrorTitle":"Fehler","captureErrorMessage":"Erfassung konnte nicht erfolgreich durchgeführt werden.","captureSuccessTitle":"Erfolg","captureSuccessMessage":"Erfassung erfolgreich durchgeführt.","refundErrorTitle":"Fehler","refundErrorMessage":"Erstattung konnte nicht erfolgreich durchgeführt werden.","refundSuccessTitle":"Erfolg","refundSuccessMessage":"Erstattung erfolgreich durchgeführt.","updateErrorTitle":"Fehler","updateErrorMessage":"Klarna hat die Änderung der Bestellung nicht akzeptiert."}}}')},KWim:function(e,t){var n=Shopware.Component,a=Shopware.Data.Criteria;n.extend("klarna-select-delivery-state","sw-entity-single-select",{props:{criteria:{type:Object,required:!1,default:function(){var e=new a(1,100);return e.addFilter(a.equals("stateMachine.technicalName","order_delivery.state")),e}}}})},Mf2p:function(e,t,n){},PPuK:function(e,t,n){var a=n("0Uoz");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n("SZ7m").default)("ec17604e",a,!0,{})},RZWV:function(e,t,n){var a=n("SOw4");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n("SZ7m").default)("2207a840",a,!0,{})},SOw4:function(e,t,n){},SZ7m:function(e,t,n){"use strict";function a(e,t){for(var n=[],a={},r=0;r<t.length;r++){var i=t[r],o=i[0],s={id:e+":"+r,css:i[1],media:i[2],sourceMap:i[3]};a[o]?a[o].parts.push(s):n.push(a[o]={id:o,parts:[s]})}return n}n.r(t),n.d(t,"default",(function(){return f}));var r="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!r)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var i={},o=r&&(document.head||document.getElementsByTagName("head")[0]),s=null,l=0,c=!1,u=function(){},d=null,m="data-vue-ssr-id",p="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function f(e,t,n,r){c=n,d=r||{};var o=a(e,t);return h(o),function(t){for(var n=[],r=0;r<o.length;r++){var s=o[r];(l=i[s.id]).refs--,n.push(l)}t?h(o=a(e,t)):o=[];for(r=0;r<n.length;r++){var l;if(0===(l=n[r]).refs){for(var c=0;c<l.parts.length;c++)l.parts[c]();delete i[l.id]}}}}function h(e){for(var t=0;t<e.length;t++){var n=e[t],a=i[n.id];if(a){a.refs++;for(var r=0;r<a.parts.length;r++)a.parts[r](n.parts[r]);for(;r<n.parts.length;r++)a.parts.push(y(n.parts[r]));a.parts.length>n.parts.length&&(a.parts.length=n.parts.length)}else{var o=[];for(r=0;r<n.parts.length;r++)o.push(y(n.parts[r]));i[n.id]={id:n.id,refs:1,parts:o}}}}function g(){var e=document.createElement("style");return e.type="text/css",o.appendChild(e),e}function y(e){var t,n,a=document.querySelector("style["+m+'~="'+e.id+'"]');if(a){if(c)return u;a.parentNode.removeChild(a)}if(p){var r=l++;a=s||(s=g()),t=w.bind(null,a,r,!1),n=w.bind(null,a,r,!0)}else a=g(),t=v.bind(null,a),n=function(){a.parentNode.removeChild(a)};return t(e),function(a){if(a){if(a.css===e.css&&a.media===e.media&&a.sourceMap===e.sourceMap)return;t(e=a)}else n()}}var b,k=(b=[],function(e,t){return b[e]=t,b.filter(Boolean).join("\n")});function w(e,t,n,a){var r=n?"":a.css;if(e.styleSheet)e.styleSheet.cssText=k(t,r);else{var i=document.createTextNode(r),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(i,o[t]):e.appendChild(i)}}function v(e,t){var n=t.css,a=t.media,r=t.sourceMap;if(a&&e.setAttribute("media",a),d.ssrId&&e.setAttribute(m,t.id),r&&(n+="\n/*# sourceURL="+r.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}},U3cS:function(e,t){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function a(){"use strict";a=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",l=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function d(e,t,n,a){var r=t&&t.prototype instanceof f?t:f,o=Object.create(r.prototype),s=new P(a||[]);return i(o,"_invoke",{value:_(e,n,s)}),o}function m(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=d;var p={};function f(){}function h(){}function g(){}var y={};u(y,s,(function(){return this}));var b=Object.getPrototypeOf,k=b&&b(b(E([])));k&&k!==t&&r.call(k,s)&&(y=k);var w=g.prototype=f.prototype=Object.create(y);function v(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function a(i,o,s,l){var c=m(e[i],e,o);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==n(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){a("next",e,s,l)}),(function(e){a("throw",e,s,l)})):t.resolve(d).then((function(e){u.value=e,s(u)}),(function(e){return a("throw",e,s,l)}))}l(c.arg)}var o;i(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){a(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function _(e,t,n){var a="suspendedStart";return function(r,i){if("executing"===a)throw new Error("Generator is already running");if("completed"===a){if("throw"===r)throw i;return A()}for(n.method=r,n.arg=i;;){var o=n.delegate;if(o){var s=O(o,n);if(s){if(s===p)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===a)throw a="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a="executing";var l=m(e,t,n);if("normal"===l.type){if(a=n.done?"completed":"suspendedYield",l.arg===p)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(a="completed",n.method="throw",n.arg=l.arg)}}}function O(e,t){var n=t.method,a=e.iterator[n];if(void 0===a)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var r=m(a,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,p;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function E(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:A}}function A(){return{value:void 0,done:!0}}return h.prototype=g,i(w,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:h,configurable:!0}),h.displayName=u(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,u(e,c,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},v(S.prototype),u(S.prototype,l,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,a,r,i){void 0===i&&(i=Promise);var o=new S(d(t,n,a,r),i);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},v(w),u(w,c,"Generator"),u(w,s,(function(){return this})),u(w,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var a in t)n.push(a);return n.reverse(),function e(){for(;n.length;){var a=n.pop();if(a in t)return e.value=a,e.done=!1,e}return e.done=!0,e}},e.values=E,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,a){return o.type="throw",o.arg=e,t.next=n,a&&(t.method="next",t.arg=void 0),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),x(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var r=a.arg;x(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:E(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function r(e,t,n,a,r,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(a,r)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var o=e.apply(t,n);function s(e){r(o,a,i,s,l,"next",e)}function l(e){r(o,a,i,s,l,"throw",e)}s(void 0)}))}}var o=Shopware,s=o.Component,l=o.Mixin;s.override("sw-order-detail-base",{inject:["KlarnaPaymentOrderUpdateService"],mixins:[l.getByName("notification")],methods:{onSaveEdits:function(){var e=this;this.$emit("loading-change",!0),this.$emit("editing-change",!1),this.KlarnaPaymentOrderUpdateService.updateOrder(this.orderId,this.versionContext.versionId).then(i(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$super("onSaveEdits");case 2:case"end":return t.stop()}}),t)})))).catch((function(){e.createNotificationError({title:e.$tc("klarna-payment-order-management.messages.updateErrorTitle"),message:e.$tc("klarna-payment-order-management.messages.updateErrorMessage")}),e.versionContext.versionId=Shopware.Context.api.liveVersionId,e.reloadEntityData()}))}}})},UPyP:function(e,t,n){var a=n("9vXG");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n("SZ7m").default)("4f8475be",a,!0,{})},Wv6P:function(e,t){var n=Shopware.Component,a=Shopware.Data.Criteria;n.extend("klarna-select-order-state","sw-entity-single-select",{props:{criteria:{type:Object,required:!1,default:function(){var e=new a(1,100);return e.addFilter(a.equals("stateMachine.technicalName","order.state")),e}}}})},XkoY:function(e,t){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return(t=l(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,l(a.key),a)}}function l(e){var t=function(e,t){if("object"!==n(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!==n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===n(t)?t:String(t)}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=m(e);if(t){var r=m(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return d(this,n)}}function d(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}var p=Shopware.Application,f=Shopware.Classes.ApiService,h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(l,e);var t,n,a,i=u(l);function l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"klarna_payment";return o(this,l),i.call(this,e,t,n)}return t=l,(n=[{key:"validateCredentials",value:function(e,t){var n=r(r({},e),{},{endpoint:t});return this.httpClient.post("_action/".concat(this.getApiBasePath(),"/validate-credentials"),n,{headers:this.getBasicHeaders()}).then((function(e){return f.handleResponse(e)}))}},{key:"getEuApiRegionKey",value:function(){return this.getApiRegionKey("eu")}},{key:"getUsApiRegionKey",value:function(){return this.getApiRegionKey("us")}},{key:"getApiRegionKey",value:function(e){return this.httpClient.post("_action/".concat(this.getApiBasePath(),"/fetch-").concat(e,"-api-region-key"),{},{headers:this.getBasicHeaders()}).then((function(e){return f.handleResponse(e)}))}}])&&s(t.prototype,n),a&&s(t,a),Object.defineProperty(t,"prototype",{writable:!1}),l}(f);p.addServiceProvider("KlarnaPaymentConfigurationService",(function(e){var t=p.getContainer("init");return new h(t.httpClient,e.loginService)}))},a4UF:function(e,t){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==n(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!==n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===n(o)?o:String(o)),r)}var i,o}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=l(e);if(t){var r=l(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return s(this,n)}}function s(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var c=Shopware.Application,u=Shopware.Classes.ApiService,d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(c,e);var t,n,s,l=o(c);function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"klarna_payment";return a(this,c),l.call(this,e,t,n)}return t=c,(n=[{key:"fetchOrderData",value:function(e,t){return this.httpClient.post("_action/".concat(this.getApiBasePath(),"/fetch_order"),{klarna_order_id:e,salesChannel:t},{headers:this.getBasicHeaders()}).then((function(e){return u.handleResponse(e)}))}},{key:"captureOrder",value:function(e){return this.httpClient.post("_action/".concat(this.getApiBasePath(),"/capture_order"),e,{headers:this.getBasicHeaders()}).then((function(e){return u.handleResponse(e)}))}},{key:"refundOrder",value:function(e){return this.httpClient.post("_action/".concat(this.getApiBasePath(),"/refund_order"),e,{headers:this.getBasicHeaders()}).then((function(e){return u.handleResponse(e)}))}},{key:"cancelPayment",value:function(e,t,n){var a=this.getBasicHeaders();return this.httpClient.post("_action/".concat(this.getApiBasePath(),"/cancel_payment"),{orderTransactionId:e,klarna_order_id:t,salesChannel:n},{headers:a}).then((function(e){return u.handleResponse(e)}))}},{key:"releaseRemainingAuthorization",value:function(e,t){var n=this.getBasicHeaders();return this.httpClient.post("_action/".concat(this.getApiBasePath(),"/release_remaining_authorization"),{klarna_order_id:e,salesChannel:t},{headers:n}).then((function(e){return u.handleResponse(e)}))}},{key:"extendAuthorization",value:function(e){var t=this.getBasicHeaders();return this.httpClient.post("_action/".concat(this.getApiBasePath(),"/extend_authorization"),{klarna_order_id:e},{headers:t}).then((function(e){return u.handleResponse(e)}))}}])&&r(t.prototype,n),s&&r(t,s),Object.defineProperty(t,"prototype",{writable:!1}),c}(u);c.addServiceProvider("KlarnaPaymentOrderService",(function(e){var t=c.getContainer("init");return new d(t.httpClient,e.loginService)}))},cT0X:function(e,t,n){},"d/ue":function(e,t,n){var a=n("k2fQ");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n("SZ7m").default)("419f275f",a,!0,{})},fcOp:function(e,t,n){var a=n("cT0X");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n("SZ7m").default)("93947946",a,!0,{})},gBKS:function(e,t,n){"use strict";n.r(t);n("XkoY"),n("a4UF"),n("hJRR"),n("0wRg");Shopware.Component.register("klarna-payment-plugin-icon",{template:"{% block klarna_payment_plugin_icon %}\n    <img :src=\"'klarnapayment/administration/plugin.png' | asset\">\n{% endblock %}\n"});n("Wv6P"),n("KWim");Shopware.Component.extend("klarna-select-payment-codes","sw-multi-select",{template:"{% block sw_multi_select %}\n    <div>\n\n        <div class=\"klarna-payment-settings-kp__info\">\n            <ul>\n                <li>\n                    <h3>{{ $tc('klarna-payment-configuration.settingsForm.klarnaPayments.payLater.title') }}</h3>\n                    <img src=\"https://x.klarnacdn.net/payment-method/assets/badges/generic/klarna.png\" :title=\"$tc('klarna-payment-configuration.settingsForm.klarnaPayments.payLater.title')\" :alt=\"$tc('klarna-payment-configuration.settingsForm.klarnaPayments.payLater.title')\"/>\n                    <p>{{ $tc('klarna-payment-configuration.settingsForm.klarnaPayments.payLater.description') }}</p>\n                </li>\n                <li>\n                    <h3>{{ $tc('klarna-payment-configuration.settingsForm.klarnaPayments.sliceIt.title') }}</h3>\n                    <img src=\"https://x.klarnacdn.net/payment-method/assets/badges/generic/klarna.png\" :title=\"$tc('klarna-payment-configuration.settingsForm.klarnaPayments.sliceIt.title')\" :alt=\"$tc('klarna-payment-configuration.settingsForm.klarnaPayments.sliceIt.title')\"/>\n                    <p>{{ $tc('klarna-payment-configuration.settingsForm.klarnaPayments.sliceIt.description') }}</p>\n                </li>\n                <li>\n                    <h3>{{ $tc('klarna-payment-configuration.settingsForm.klarnaPayments.payNow.title') }}</h3>\n                    <img src=\"https://x.klarnacdn.net/payment-method/assets/badges/generic/klarna.png\" :title=\"$tc('klarna-payment-configuration.settingsForm.klarnaPayments.payNow.title')\" :alt=\"$tc('klarna-payment-configuration.settingsForm.klarnaPayments.payNow.title')\"/>\n                    <p>{{ $tc('klarna-payment-configuration.settingsForm.klarnaPayments.payNow.description') }}</p>\n                    <p><sw-icon name=\"default-badge-info\" small color=\"#3498db\"></sw-icon> {{ $tc('klarna-payment-configuration.settingsForm.klarnaPayments.payNow.additional') }}</p>\n                </li>\n            </ul>\n        </div>\n\n        {% parent %}\n\n    </div>\n{% endblock %}\n"});n("jgmv");var a=Shopware.Component,r=Shopware.Context.app.config.version.match(/((\d+)\.?(\d+?)\.?(\d+)?\.?(\d*))-?([A-z]+?\d+)?/i);r&&6===parseInt(r[2])&&parseInt(r[3])<4&&a.override("sw-settings-index",{template:'{% block sw_settings_content_card_slot_plugins %}\n    {% parent %}\n\n    <sw-settings-item :label="$tc(\'klarna-payment-configuration.module.title\')"\n      :to="{ name: \'klarna.payment.configuration.settings\' }"\n      :backgroundEnabled="false">\n        <template #icon>\n            <img :src="\'klarnapayment/administration/plugin.png\' | asset">\n        </template>\n    </sw-settings-item>\n{% endblock %}'});n("fcOp");var i=Shopware,o=i.Component,s=i.Mixin,l=i.Context,c=Shopware.Data.Criteria,u=l.app.config.version.match(/((\d+)\.?(\d+?)\.?(\d+)?\.?(\d*))-?([A-z]+?\d+)?/i),d='{% block klarna_payment_settings %}\n    <sw-page class="klarna-payment">\n        {% block klarna_payment_settings_header %}\n            <template slot="smart-bar-header">\n                <h2>\n                    {{ $tc(\'sw-settings.index.title\') }}\n                    <sw-icon\n                        :name="arrowIconName"\n                        small\n                    />\n                    {{ $tc(\'klarna-payment-configuration.settingsForm.title\') }}\n                </h2>\n            </template>\n        {% endblock %}\n\n        {% block klarna_payment_settings_actions %}\n            <template slot="smart-bar-actions">\n                {% block klarna_payment_settings_actions_wizard %}\n                    <sw-button\n                      :disabled="isLoading || isTesting"\n                      @click="onWizard">\n                        {{ $tc(\'klarna-payment-configuration.settingsForm.buttons.wizard\') }}\n                    </sw-button>\n                {% endblock %}\n                {% block klarna_payment_settings_actions_test %}\n                    <sw-button-process\n                      :isLoading="isTesting"\n                      :processSuccess="isTestSuccessful"\n                      @process-finish="onTestFinished()"\n                      :disabled="isLoading"\n                      @click="onTest()">\n                        {{ $tc(\'klarna-payment-configuration.settingsForm.buttons.test\') }}\n                    </sw-button-process>\n                {% endblock %}\n\n                {% block klarna_payment_settings_actions_save %}\n                    <sw-button-process\n                      class="sw-settings-login-registration__save-action"\n                      :isLoading="isLoading"\n                      :processSuccess="isSaveSuccessful"\n                      @process-finish="onSaveFinished()"\n                      :disabled="isLoading || isTesting"\n                      variant="primary"\n                      @click="onSave">\n                        {{ $tc(\'klarna-payment-configuration.settingsForm.buttons.save\') }}\n                    </sw-button-process>\n                {% endblock %}\n            </template>\n        {% endblock %}\n\n        {% block klarna_payment_settings_content %}\n            <template slot="content">\n                <sw-card :hero="true" :isLoading="false" :large="false">\n                    <sw-alert variant="info" appearance="default" :showIcon="true" :closable="false">\n                        {{ $tc(\'klarna-payment-configuration.settingsForm.inheritanceWarning\') }}\n                    </sw-alert>\n                </sw-card>\n\n                {#\n                TODO: Enable once Klarna enables the payment method\n            <sw-card v-if="showNotificationGlobalPurchaseFlowMissing">\n                <sw-alert variant="info" appearance="default" :showIcon="true" :closable="false">\n                    {{ $tc(\'klarna-payment-configuration.settingsForm.globalPurchaseMissingInfo\') }}\n                </sw-alert>\n            </sw-card>\n                #}\n\n                <sw-card-view>\n                    <sw-system-config\n                        ref="systemConfig"\n                        salesChannelSwitchable\n                        inherit\n                        @config-changed="onConfigChange"\n                        @saleschannel-changed="setSalesChannelDomainsWithoutHttps"\n                        domain="KlarnaPayment.settings">\n\n                        {#\n                        TODO: Enable once Klarna enables the payment method\n                    <template #beforeElements="{ card, config }">\n                        <template v-if="!showNotificationGlobalPurchaseFlowMissing">\n                            <template v-if="card.name == \'payment_settings\'">\n                                <sw-alert variant="info" appearance="default" :showIcon="true" :closable="false">\n                                    {{ $tc(\'klarna-payment-configuration.settingsForm.deprecatedConfiguration\') }}\n                                </sw-alert>\n                            </template>\n                        </template>\n                    </template>\n                        #}\n\n                        <template #card-element="{ element, config }">\n                            <div v-show="displayField(element, config)">\n                                <div v-if="element.name.endsWith(\'testMode\')">\n                                    <sw-alert\n                                        variant="info"\n                                        appearance="pill">\n                                        {{ $tc(\'klarna-payment-configuration.settingsForm.apiConfiguration.notice\') }}\n                                    </sw-alert>\n                                </div>\n\n                                <sw-form-field-renderer v-bind="$refs.systemConfig.getElementBind(element)"\n                                                        v-model="$refs.systemConfig.actualConfigData[$refs.systemConfig.currentSalesChannelId][element.name]">\n                                </sw-form-field-renderer>\n\n                                <div v-if="element.name.endsWith(\'isOnsiteMessagingActive\')" class="klarna-field--osm-description">\n                                    <p>\n                                        <a v-if="getConfigValue(\'testMode\')" target="_blank"\n                                          :href="$tc(\'klarna-payment-configuration.settingsForm.onsiteMessaging.playgroundUrl\')">\n                                            <sw-button size="x-small">\n                                                {{ $tc(\'klarna-payment-configuration.settingsForm.onsiteMessaging.generate\')}}\n                                            </sw-button>\n                                        </a>\n                                        <a v-else target="_blank"\n                                          :href="$tc(\'klarna-payment-configuration.settingsForm.onsiteMessaging.defaultUrl\')">\n                                            <sw-button size="x-small">\n                                                {{ $tc(\'klarna-payment-configuration.settingsForm.onsiteMessaging.generate\')}}\n                                            </sw-button>\n                                        </a>\n                                    </p>\n                                </div>\n                            </div>\n                        </template>\n                    </sw-system-config>\n                </sw-card-view>\n            </template>\n        {% endblock %}\n    </sw-page>\n{% endblock %}\n';u&&6===parseInt(u[2],10)&&(parseInt(u[3],10)>3||parseInt(u[4],10)>4)&&(d='{% block klarna_payment_settings %}\n    <sw-page class="klarna-payment">\n        {% block klarna_payment_settings_header %}\n            <template slot="smart-bar-header">\n                <h2>\n                    {{ $tc(\'sw-settings.index.title\') }}\n                    <sw-icon\n                        :name="arrowIconName"\n                        small\n                    />\n                    {{ $tc(\'klarna-payment-configuration.settingsForm.title\') }}\n                </h2>\n            </template>\n        {% endblock %}\n\n        {% block klarna_payment_settings_actions %}\n            <template slot="smart-bar-actions">\n                {% block klarna_payment_settings_actions_wizard %}\n                    <sw-button\n                      :disabled="isLoading || isTesting"\n                      @click="onWizard">\n                        {{ $tc(\'klarna-payment-configuration.settingsForm.buttons.wizard\') }}\n                    </sw-button>\n                {% endblock %}\n                {% block klarna_payment_settings_actions_test %}\n                    <sw-button-process\n                      :isLoading="isTesting"\n                      :processSuccess="isTestSuccessful"\n                      @process-finish="onTestFinished()"\n                      :disabled="isLoading"\n                      @click="onTest()">\n                        {{ $tc(\'klarna-payment-configuration.settingsForm.buttons.test\') }}\n                    </sw-button-process>\n                {% endblock %}\n\n                {% block klarna_payment_settings_actions_save %}\n                    <sw-button-process\n                      class="sw-settings-login-registration__save-action"\n                      :isLoading="isLoading"\n                      :processSuccess="isSaveSuccessful"\n                      @process-finish="onSaveFinished()"\n                      :disabled="isLoading || isTesting"\n                      variant="primary"\n                      @click="onSave">\n                        {{ $tc(\'klarna-payment-configuration.settingsForm.buttons.save\') }}\n                    </sw-button-process>\n                {% endblock %}\n            </template>\n        {% endblock %}\n\n        {% block klarna_payment_settings_content %}\n            <template slot="content">\n                <sw-card-view>\n                    {#\n                        TODO: Enable once Klarna enables the payment method\n                    <sw-card v-if="showNotificationGlobalPurchaseFlowMissing">\n                        <sw-alert variant="info" appearance="default" :showIcon="true" :closable="false">\n                            {{ $tc(\'klarna-payment-configuration.settingsForm.globalPurchaseMissingInfo\') }}\n                        </sw-alert>\n                    </sw-card>\n                    #}\n\n                    <sw-system-config\n                        ref="systemConfig"\n                        salesChannelSwitchable\n                        inherit\n                        @config-changed="onConfigChange"\n                        @saleschannel-changed="setSalesChannelDomainsWithoutHttps"\n                        domain="KlarnaPayment.settings"\n                    >\n                        <template #beforeElements="{ card, config }">\n                            {#\n                                TODO: Enable once Klarna enables the payment method\n                            <template v-if="!showNotificationGlobalPurchaseFlowMissing">\n                                <template v-if="card.name == \'payment_settings\'">\n                                    <sw-alert variant="info" appearance="default" :showIcon="true" :closable="false">\n                                        {{ $tc(\'klarna-payment-configuration.settingsForm.deprecatedConfiguration\') }}\n                                    </sw-alert>\n                                </template>\n                            </template>\n                            #}\n                        </template>\n\n                        <template #card-element="{ element, config }">\n                            <sw-inherit-wrapper\n                                v-model="$refs.systemConfig.actualConfigData[$refs.systemConfig.currentSalesChannelId][element.name]"\n                                v-bind="$refs.systemConfig.getInheritWrapperBind(element)"\n                                :has-parent="$refs.systemConfig.isNotDefaultSalesChannel"\n                                :inherited-value="$refs.systemConfig.getInheritedValue(element)"\n                                :class="\'sw-system-config--field-\' + $refs.systemConfig.kebabCase($refs.systemConfig.getElementBind(element).name)"\n                            >\n                                <template #content="props">\n                                    <div v-show="displayField(element, config)">\n                                        <div v-if="element.name.endsWith(\'testMode\')">\n                                            <sw-alert\n                                                variant="info"\n                                                appearance="pill">\n                                                {{ $tc(\'klarna-payment-configuration.settingsForm.apiConfiguration.notice\') }}\n                                            </sw-alert>\n                                        </div>\n\n                                        <sw-form-field-renderer\n                                          v-bind="$refs.systemConfig.getElementBind(element, props)"\n                                          :key="props.isInheritField + props.isInherited"\n                                          :disabled="props.isInherited"\n                                          :value="props.currentValue"\n                                          @input="props.updateCurrentValue"\n                                          @change="props.updateCurrentValue"\n                                          />\n\n                                        <div v-if="element.name.endsWith(\'isOnsiteMessagingActive\')" class="klarna-field--osm-description">\n                                            <p>\n                                                <a v-if="getConfigValue(\'testMode\')" target="_blank"\n                                                  :href="$tc(\'klarna-payment-configuration.settingsForm.onsiteMessaging.playgroundUrl\')">\n                                                    <sw-button size="x-small">\n                                                        {{ $tc(\'klarna-payment-configuration.settingsForm.onsiteMessaging.generate\')}}\n                                                    </sw-button>\n                                                </a>\n                                                <a v-else target="_blank"\n                                                  :href="$tc(\'klarna-payment-configuration.settingsForm.onsiteMessaging.defaultUrl\')">\n                                                    <sw-button size="x-small">\n                                                        {{ $tc(\'klarna-payment-configuration.settingsForm.onsiteMessaging.generate\')}}\n                                                    </sw-button>\n                                                </a>\n                                            </p>\n                                        </div>\n                                    </div>\n                                </template>\n                            </sw-inherit-wrapper>\n                        </template>\n                    </sw-system-config>\n                </sw-card-view>\n            </template>\n        {% endblock %}\n   </sw-page>\n{% endblock %}\n'),o.register("klarna-payment-settings",{template:d,mixins:[s.getByName("notification"),s.getByName("sw-inline-snippet")],inject:["repositoryFactory","KlarnaPaymentConfigurationService"],data:function(){return{euApiRegionKey:"",usApiRegionKey:"",apiRegionKeys:[],isLoading:!1,isTesting:!1,isTestSuccessful:!1,isSaveSuccessful:!1,config:{},paymentMethods:[],externalCheckoutPaymentMethods:[],configDomain:"KlarnaPayment.settings.",salesChannelDomainsWithoutHttps:[],showNotificationGlobalPurchaseFlowMissing:!1}},metaInfo:function(){return{title:this.$createTitle()}},created:function(){this.createdComponent()},computed:{paymentMethodRepository:function(){return this.repositoryFactory.create("payment_method")},salesChannelDomainRepository:function(){return this.repositoryFactory.create("sales_channel_domain")},arrowIconName:function(){return u[3]>=5?"regular-chevron-right-xs":"small-arrow-medium-right"}},methods:{createdComponent:function(){var e=this;this.setSalesChannelDomainsWithoutHttps(),this.paymentMethodRepository.search(new c,l.api).then((function(t){t.forEach((function(t){e.paymentMethods.push({value:t.id,label:t.name}),"handler_swag_paypalpaymenthandler"===t.formattedHandlerIdentifier&&e.externalCheckoutPaymentMethods.push({value:t.id,label:t.name})}))})),this.KlarnaPaymentConfigurationService.getEuApiRegionKey().then((function(t){e.euApiRegionKey=t.data.key,e.apiRegionKeys.push(e.euApiRegionKey)})),this.KlarnaPaymentConfigurationService.getUsApiRegionKey().then((function(t){e.usApiRegionKey=t.data.key,e.apiRegionKeys.push(e.usApiRegionKey)}))},setSalesChannelDomainsWithoutHttps:function(){var e=this,t=new c;t.addFilter(c.not("AND",[c.contains("url","https://")])),this.$refs.systemConfig&&this.$refs.systemConfig.currentSalesChannelId&&t.addFilter(c.equals("salesChannelId",this.$refs.systemConfig.currentSalesChannelId)),e.salesChannelDomainsWithoutHttps=[],this.salesChannelDomainRepository.search(t,l.api).then((function(t){t.forEach((function(t){e.salesChannelDomainsWithoutHttps.push(t.url)}))}))},getConfigValue:function(e){if(void 0===this.$refs.systemConfig)return null;var t=this.$refs.systemConfig.currentSalesChannelId,n=this.$refs.systemConfig.actualConfigData.null[this.configDomain+e];if(null===t)return n;var a=this.config[this.configDomain+e];return null==a?n:a},onTest:function(){this.testCredentials(!1)},testCredentials:function(e){var t=this,n=this,a=n.apiRegionKeys.length;n.apiRegionKeys.forEach((function(r){e?(t.isSaveSuccessful=!1,t.isLoading=!0):(n.isTestSuccessful=!1,n.isTesting=!0);var i={testMode:n.getConfigValue("testMode"),salesChannel:n.$refs.systemConfig.currentSalesChannelId},o=r===n.usApiRegionKey?"US":"";if(i.apiUsername=n.getConfigValue("apiUsername"+o),i.apiPassword=n.getConfigValue("apiPassword"+o),i.testApiUsername=n.getConfigValue("testApiUsername"+o),i.testApiPassword=n.getConfigValue("testApiPassword"+o),!n.shouldTestCredentials(i))return--a,void n.releaseLoadingAndSave(e,a);n.KlarnaPaymentConfigurationService.validateCredentials(i,r).then((function(){n.createNotificationSuccess({title:n.$tc("klarna-payment-configuration.settingsForm.messages.titleSuccess"),message:n.$tc("klarna-payment-configuration.settingsForm.messages.messageTest"+r+"Success")}),e?n.isSaveSuccessful=!0:n.isTestSuccessful=!0,--a})).catch((function(){n.createNotificationError({title:n.$tc("klarna-payment-configuration.settingsForm.messages.titleError"),message:n.$tc("klarna-payment-configuration.settingsForm.messages.messageTest"+r+"Error"+(i.testMode?"Test":"Live"))})})).finally((function(){n.releaseLoadingAndSave(e,a)}))}))},releaseLoadingAndSave:function(e,t){var n=this;e?(n.isLoading=!1,t<=0&&n.$refs.systemConfig.saveAll()):n.isTesting=!1},shouldTestCredentials:function(e){return e.testMode?e.testApiPassword&&e.testApiPassword.length>0||e.testApiUsername&&e.testApiUsername.length>0:e.apiPassword&&e.apiPassword.length>0||e.apiUsername&&e.apiUsername.length>0},onSave:function(){this.testCredentials(!0)},onConfigChange:function(e){this.config=e,this.showNotificationGlobalPurchaseFlowMissing=!this.getConfigValue("activeGlobalPurchaseFlow"),this.redirectToWizard()},redirectToWizard:function(){this.getConfigValue("isInitialized")||this.$router.push({name:"klarna.payment.configuration.wizard"})},onSaveFinished:function(){this.isSaveSuccessful=!1},onTestFinished:function(){this.isTestSuccessful=!1},getBind:function(e,t){return t!==this.config&&(this.config=t),e},onWizard:function(){this.$router.push({name:"klarna.payment.configuration.wizard"})},displayField:function(e,t){return e.name!=="".concat(this.configDomain,"isInitialized")&&(e.name!=="".concat(this.configDomain,"activeGlobalPurchaseFlow")&&(e.name==="".concat(this.configDomain,"onsiteMessagingScript")||e.name==="".concat(this.configDomain,"onsiteMessagingSnippet")?null==t["".concat(this.configDomain,"isOnsiteMessagingActive")]?!0===this.getConfigValue("isOnsiteMessagingActive"):!0===t["".concat(this.configDomain,"isOnsiteMessagingActive")]:0===e.name.replace(this.configDomain,"").indexOf("klarnaExpress")?null==t["".concat(this.configDomain,"isKlarnaExpressActive")]?!0===this.getConfigValue("isKlarnaExpressActive"):!0===t["".concat(this.configDomain,"isKlarnaExpressActive")]:e.name==="".concat(this.configDomain,"captureOrderStatus")?"orderStatus"===this.getConfigValue("automaticCapture"):e.name==="".concat(this.configDomain,"captureDeliveryStatus")?"deliveryStatus"===this.getConfigValue("automaticCapture"):e.name==="".concat(this.configDomain,"refundOrderStatus")?"orderStatus"===this.getConfigValue("automaticRefund"):e.name==="".concat(this.configDomain,"refundDeliveryStatus")?"deliveryStatus"===this.getConfigValue("automaticRefund"):e.name==="".concat(this.configDomain,"newsletterCheckboxLabel")?t["".concat(this.configDomain,"enableNewsletterCheckbox")]:e.name==="".concat(this.configDomain,"accountCheckboxLabel")?t["".concat(this.configDomain,"enableAccountCheckbox")]:e.name==="".concat(this.configDomain,"kcoFooterBadgeStyle")||e.name==="".concat(this.configDomain,"kcoFooterBadgeCountryCode")?t["".concat(this.configDomain,"kcoDisplayFooterBadge")]:e.name!=="".concat(this.configDomain,"kcoFooterBadgeWidth")||t["".concat(this.configDomain,"kcoDisplayFooterBadge")]))}}});n("yKc4");var m=Shopware,p=m.Component,f=m.Mixin;p.register("klarna-payment-wizard",{template:'{% block klarna_payment_wizard %}\n    <sw-page class="klarna-payment--wizard" v-bind:class="{ \'is--mobile\': isMobile }">\n        {% block klarna_payment_wizard_header %}\n            <template slot="smart-bar-header">\n                <h2>\n                    {{ $tc(\'klarna-payment-configuration.wizard.title\') }}\n                </h2>\n            </template>\n        {% endblock %}\n\n        {% block klarna_payment_wizard_content %}\n            <template slot="content">\n                <sw-card-view>\n                    <sw-card :isLoading="isLoading">\n                        <sw-container columns="1fr 3fr" class="klarna-payment-detail--transaction-details" gap="0px 32px">\n                            <sw-container>\n                                <sw-step-display\n                                  class="wizard-navigation"\n                                  :itemIndex="step"\n                                  :itemVariant="stepVariant">\n\n                                    <sw-step-item>\n                                        {{ $tc(\'klarna-payment-configuration.wizard.steps.welcome\') }}\n                                    </sw-step-item>\n\n                                    <sw-step-item>\n                                        {{ $tc(\'klarna-payment-configuration.wizard.steps.salesChannel\') }}\n                                    </sw-step-item>\n\n                                    <sw-step-item>\n                                        {{ $tc(\'klarna-payment-configuration.wizard.steps.documentation\') }}\n                                    </sw-step-item>\n                                </sw-step-display>\n                            </sw-container>\n\n                            <sw-container>\n                                <sw-container v-if="step == 0" gap="20px 0px">\n                                    <sw-container>\n                                        <div class="logo">\n                                            <img src="https://cdn.klarna.com/1.0/shared/image/generic/logo/de_de/basic/logo_black.png" alt="logo">\n                                        </div>\n                                    </sw-container>\n\n                                    <sw-container>\n                                        <span v-html=" $tc(\'klarna-payment-configuration.wizard.content.welcome.customer\')"></span>\n                                    </sw-container>\n\n                                    <sw-container>\n                                        <span v-html="$tc(\'klarna-payment-configuration.wizard.content.welcome.registration\')"></span>\n                                    </sw-container>\n\n                                    <sw-container>\n                                        <span v-html="$tc(\'klarna-payment-configuration.wizard.content.welcome.installation\')"></span>\n                                    </sw-container>\n                                </sw-container>\n\n                                <sw-container v-if="step == 1" gap="20px 0px">\n                                    <sw-sales-channel-switch\n                                      :label="$tc(\'sw-settings.system-config.labelSalesChannelSelect\')"\n                                      @change-sales-channel-id="onSalesChannelChanged">\n                                    </sw-sales-channel-switch>\n\n                                    <template v-for="(item, index) in salesChannels">\n                                        <sw-container columns="1fr 1fr" :class="item.id" v-if="item.id == currentSalesChannelId">\n                                            <sw-container>\n                                                {{ $tc(\'klarna-payment-configuration.wizard.klarnaProduct\') }}\n                                            </sw-container>\n\n                                            <sw-container>\n                                                <sw-field type="select" size="small" v-model="item.klarnaType">\n                                                    <option key="deactivated" value="deactivated" :selected="item.klarnaType === \'deactivated\'">\n                                                        {{ $tc(\'klarna-payment-configuration.wizard.type.deactivated\') }}\n                                                    </option>\n\n                                                    <option key="payments" value="payments" :selected="item.klarnaType === \'payments\'">\n                                                        {{ $tc(\'klarna-payment-configuration.wizard.type.payments\') }}\n                                                    </option>\n                                                </sw-field>\n                                            </sw-container>\n                                        </sw-container>\n                                    </template>\n                                </sw-container>\n\n                                <sw-container v-if="step == 2" gap="20px 0px">\n                                    <sw-container>\n                                        <span v-html="$tc(\'klarna-payment-configuration.wizard.content.documentation.headline\')"></span>\n                                    </sw-container>\n\n                                    <sw-container>\n                                        <span v-html="$tc(\'klarna-payment-configuration.wizard.content.documentation.introduction\')"></span>\n                                    </sw-container>\n\n                                    <sw-container>\n                                        <span v-html="$tc(\'klarna-payment-configuration.wizard.content.documentation.conclusion\')"></span>\n                                    </sw-container>\n                                </sw-container>\n                            </sw-container>\n                        </sw-container>\n\n                        <sw-container columns="1fr 1fr" gap="32px 32px" class="wizard-footer">\n                            <sw-button :disabled="step == minStep" size="small" @click="onBack">\n                                <b>{{ $tc(\'klarna-payment-configuration.wizard.action.back\') }}</b>\n                            </sw-button>\n\n                            <sw-button v-if="step != maxStep" size="small" variant="primary" @click="onNext">\n                                {{ $tc(\'klarna-payment-configuration.wizard.action.next\') }}\n                            </sw-button>\n\n                            <sw-button v-if="step == maxStep" size="small" variant="primary" @click="onFinish">\n                                {{ $tc(\'klarna-payment-configuration.wizard.action.finish\') }}\n                            </sw-button>\n                        </sw-container>\n                    </sw-card>\n                </sw-card-view>\n            </template>\n        {% endblock %}\n    </sw-page>\n{% endblock %}\n',mixins:[f.getByName("notification"),f.getByName("sw-inline-snippet")],inject:["KlarnaPaymentWizardService"],data:function(){return{isLoading:!0,currentSalesChannelId:null,splitBreakpoint:1024,minStep:0,maxStep:2,isInitialized:!1,salesChannels:[],isMobile:null,step:0,stepVariant:"info"}},created:function(){this.createdComponent()},methods:{createdComponent:function(){this.checkViewport(),this.registerListener(),this.loadTableData()},loadTableData:function(){var e=this;this.KlarnaPaymentWizardService.fetchData().then((function(t){e.salesChannels=t.data.salesChannels,e.isInitialized=t.data.isInitialized})).catch((function(){e.createErrorNotification({title:e.$tc("klarna-payment-configuration.wizard.messages.titleError"),message:e.$tc("klarna-payment-configuration.wizard.messages.messageLoadError")})})).finally((function(){e.isLoading=!1}))},registerListener:function(){this.$device.onResize({listener:this.checkViewport.bind(this)})},checkViewport:function(){this.isMobile=this.$device.getViewportWidth()<this.splitBreakpoint},onNext:function(){this.step=this.step+1,this.step>this.maxStep&&(this.step=this.maxStep)},onBack:function(){this.step=this.step-1,this.step<this.minStep&&(this.step=this.minStep)},onFinish:function(){var e=this;this.isLoading=!0,this.KlarnaPaymentWizardService.finalizeInstallation(this.salesChannels).then((function(){e.createNotificationSuccess({title:e.$tc("klarna-payment-configuration.wizard.messages.titleSuccess"),message:e.$tc("klarna-payment-configuration.wizard.messages.messageSaveSuccess")}),e.$router.push({name:"klarna.payment.configuration.settings"})})).catch((function(){e.createErrorNotification({title:e.$tc("klarna-payment-configuration.wizard.messages.titleError"),message:e.$tc("klarna-payment-configuration.wizard.messages.messageSaveError")})})).finally((function(){e.isLoading=!1}))},onSalesChannelChanged:function(e){this.currentSalesChannelId=e}}});var h=n("w4jL"),g=n("BKmF"),y=Shopware.Module,b={type:"plugin",name:"KlarnaPayment",title:"klarna-payment-configuration.module.title",description:"klarna-payment-configuration.module.description",version:"1.0.0",targetVersion:"1.0.0",snippets:{"de-DE":h,"en-GB":g},routes:{settings:{component:"klarna-payment-settings",path:"settings",meta:{parentPath:"sw.settings.index"}},wizard:{component:"klarna-payment-wizard",path:"wizard",meta:{parentPath:"sw.settings.index"}}}},k=Shopware.Context.app.config.version.match(/((\d+)\.?(\d+?)\.?(\d+)?\.?(\d*))-?([A-z]+?\d+)?/i);k&&6===parseInt(k[2])&&parseInt(k[3])>3&&(b.settingsItem=[{name:"klarna-payment-configuration",to:"klarna.payment.configuration.settings",label:"klarna-payment-configuration.module.title",group:"plugins",iconComponent:"klarna-payment-plugin-icon",backgroundEnabled:!1}]),y.register("klarna-payment-configuration",b);n("UPyP");var w=Shopware,v=w.Component,S=w.Context,_=Shopware.Data.Criteria;v.override("sw-order-detail",{template:'{% block sw_order_detail_content_tabs_general %}\n    {% parent %}\n\n    <template v-for="transaction in klarnaTransactions">\n        {% block klarna_payment_payment_tab %}\n            <sw-tabs-item :route="{name: \'klarna-payment-order-management.payment.detail\', params: { id: $route.params.id, transaction: transaction.transaction } }" :title="$tc(\'klarna-payment-order-management.order-tab.title\')">\n                <span :class="transaction.cancelled ? \'klarna-tab-error\' : \'\'">\n                    {{ $tc(\'klarna-payment-order-management.order-tab.title\') }}\n\n                    <sw-icon v-if="transaction.cancelled"\n                      class="klarna-error-badge"\n                      name="default-badge-warning"\n                      size="14px"\n                      v-tooltip="{ message: $tc(\'klarna-payment-order-management.tooltips.transactionCancelled\') }">\n                    </sw-icon>\n                </span>\n            </sw-tabs-item>\n        {% endblock %}\n    </template>\n{% endblock %}\n',data:function(){return{klarnaTransactions:[]}},computed:{isEditable:function(){return 0===this.klarnaTransactions.length||"klarna-payment-order-management.payment.detail"!==this.$route.name}},watch:{orderId:{deep:!0,handler:function(){this.klarnaTransactions=[],this.orderId&&this.loadOrderData()},immediate:!0}},methods:{loadOrderData:function(){var e=this,t=this.repositoryFactory.create("order"),n=new _(1,1);return n.addAssociation("transactions"),n.addAssociation("transactions.stateMachineState"),t.get(this.$route.params.id,S.api,n).then((function(t){e.loadKlarnaTransactions(t)}))},loadKlarnaTransactions:function(e){var t=this;e.transactions.forEach((function(e){e.customFields&&e.customFields.klarna_order_id&&t.klarnaTransactions.push({transaction:e.id,cancelled:"cancelled"===e.stateMachineState.technicalName})}))}}});n("U3cS"),n("1KBz");function O(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var x=Shopware,P=x.Component,E=x.Mixin,A=x.Context,M=Shopware.Data.Criteria;P.register("klarna-payment-tab",{template:'{% block klarna_payment_payment_details %}\n    <div class="klarna-payment-tab" v-bind:class="{ \'is--mobile\': isMobile }">\n        <div v-if="!hasError && initialized">\n            <sw-card class="klarna-payment-details" :title="$tc(\'klarna-payment-order-management.order-details.title\')">\n                <sw-container columns="1fr 1fr" class="klarna-payment-detail--transaction-details mobile--ready" gap="0px 32px">\n                    <sw-container gap="5px">\n                        <sw-text-field :disabled="true" :label="$tc(\'klarna-payment-order-management.order-details.klarnaReference\')" :value="klarnaOrder.reference"></sw-text-field>\n\n                        <sw-text-field :disabled="true" :label="$tc(\'klarna-payment-order-management.order-details.orderAmount\')" :value="klarnaOrder.order_amount | currency(klarnaOrder.currency)"></sw-text-field>\n\n                        <sw-text-field :disabled="true" :label="$tc(\'klarna-payment-order-management.order-details.capturedAmount\')" :value="klarnaOrder.captured_amount | currency(klarnaOrder.currency)"></sw-text-field>\n\n                        <sw-text-field :disabled="true" :label="$tc(\'klarna-payment-order-management.order-details.refundedAmount\')" :value="klarnaOrder.refunded_amount | currency(klarnaOrder.currency)"></sw-text-field>\n\n                        <klarna-release-amount :klarnaOrder="klarnaOrder" v-on:reload="loadData" v-on:subComponentLoading="setSubComponentLoading"></klarna-release-amount>\n                    </sw-container>\n\n                    <sw-container gap="5px">\n                        <sw-text-field :disabled="true" :label="$tc(\'klarna-payment-order-management.order-details.klarnaOrderId\')" :value="klarnaOrder.order_id"></sw-text-field>\n\n                        <sw-text-field :disabled="true" :label="$tc(\'klarna-payment-order-management.order-details.klarnaStatus\')" :value="klarnaOrder.order_status"></sw-text-field>\n\n                        <sw-text-field :disabled="true" :label="$tc(\'klarna-payment-order-management.order-details.initialPaymentMethod\')" :value="klarnaOrder.initial_payment_method"></sw-text-field>\n\n                        <sw-text-field :helpText="$tc(\'klarna-payment-order-management.order-details.riskCheckHelpText\')"  :disabled="true" :label="$tc(\'klarna-payment-order-management.order-details.riskCheck\')" :value="klarnaOrder.fraud_status"></sw-text-field>\n\n                        <klarna-payment-authorization :klarnaOrder="klarnaOrder" v-on:reload="loadData" v-on:subComponentLoading="setSubComponentLoading" ></klarna-payment-authorization>\n                    </sw-container>\n                </sw-container>\n            </sw-card>\n\n            <sw-card class="klarna-payment-actions">\n                <sw-container columns="1fr 1fr 1fr" gap="32px 32px" class="mobile--ready">\n                    <klarna-capture-button :klarnaOrder="klarnaOrder" v-on:reload="loadData"></klarna-capture-button>\n\n                    <klarna-refund-button :klarnaOrder="klarnaOrder" v-on:reload="loadData"></klarna-refund-button>\n\n                    <klarna-order-cancel :klarnaOrder="klarnaOrder" v-on:reload="loadData" v-on:subComponentLoading="setSubComponentLoading"></klarna-order-cancel>\n                </sw-container>\n            </sw-card>\n\n            <klarna-transaction-history :klarnaHistory="klarnaHistory" :klarnaOrder="klarnaOrder" ></klarna-transaction-history>\n        </div>\n\n        <sw-loader v-if="isLoading || isSubComponentLoading"></sw-loader>\n    </div>\n{% endblock %}\n',data:function(){return{identifier:"",initialized:!1,isLoading:!0,isSubComponentLoading:!1,hasError:!1,klarnaOrder:{},splitBreakpoint:1024,isMobile:!1,klarnaHistory:{},orderAmount:[]}},created:function(){this.createdComponent()},destroyed:function(){this.destroyedComponent()},watch:{$route:function(){this.loadData()}},mixins:[E.getByName("notification")],inject:["KlarnaPaymentOrderService","repositoryFactory"],methods:{createdComponent:function(){this.$root.$on("language-change",this.loadData),this.$device.onResize({listener:this.checkViewport.bind(this)}),this.checkViewport(),this.loadData()},destroyedComponent:function(){this.$root.$off("language-change",this.loadData)},checkViewport:function(){this.isMobile=this.$device.getViewportWidth()<this.splitBreakpoint},loadData:function(){var e=this,t=this;t.isLoading=!0,t.hasError=!1;var n=this.repositoryFactory.create("order_transaction"),a=new M(1,1);return a.addAssociation("order"),a.addAssociation("order.lineItems"),n.get(this.$route.params.transaction,A.api,a).then((function(n){var a=n.customFields.klarna_order_id,r=n.order.salesChannelId;t.$emit("identifier-change",n.order.orderNumber),t.KlarnaPaymentOrderService.fetchOrderData(a,r).then((function(a){t.hasError=!1,t.initialized=!0,t.klarnaOrder=a.order,t._populateKlarnaOrderWithVariantInfo(n.order),t.klarnaOrder.salesChannel=r,t.klarnaOrder.orderTransactionId=e.$route.params.transaction,t.klarnaHistory=a.transactionHistory})).catch((function(){t.createNotificationError({title:t.$tc("klarna-payment-order-management.messages.loadErrorTitle"),message:t.$tc("klarna-payment-order-management.messages.loadErrorMessage")}),t.hasError=!0})).finally((function(){t.isLoading=!1}))})).catch((function(){t.createNotificationError({title:t.$tc("klarna-payment-order-management.messages.loadErrorTitle"),message:t.$tc("klarna-payment-order-management.messages.loadErrorMessage")}),t.hasError=!0,t.isLoading=!1}))},_populateKlarnaOrderWithVariantInfo:function(e){this.klarnaOrder.order_lines.forEach((function(t){var n,a=O(e.lineItems);try{for(a.s();!(n=a.n()).done;){var r=n.value;if(t.reference===r.payload.productNumber)return void(t.options=r.payload.options)}}catch(e){a.e(e)}finally{a.f()}}))},setSubComponentLoading:function(e){this.isSubComponentLoading=e}}});n("itAd");function $(e){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$(e)}function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function D(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==$(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!==$(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===$(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var R=Shopware,z=R.Component,j=R.Mixin;z.register("klarna-capture-button",{template:'{% block klarna_payment_payment_details %}\n    <div class="klarna-capture-button">\n        <sw-container v-tooltip="{message: $tc(\'klarna-payment-order-management.tooltips.captureImpossible\'), disabled: buttonEnabled}" :key="buttonEnabled">\n            <sw-button :disabled="!buttonEnabled" @click="openCaptureModal">\n                {{ $tc(\'klarna-payment-order-management.buttons.captureAmount\') }}\n            </sw-button>\n        </sw-container>\n\n        <sw-modal v-if="showCaptureModal" @modal-close="closeCaptureModal" :title="$tc(`klarna-payment-order-management.captureModal.title`)" class="klarna-payment-detail--capture-modal">\n            <klarna-order-items\n              :klarnaOrder="klarnaOrder"\n              mode="capture"\n              v-on:select-item="onSelectItem"\n              v-on:change-quantity="onChangeQuantity">\n            </klarna-order-items>\n\n            <div class="klarna-payment-detail--capture-modal--content">\n                <sw-container columns="1fr 1fr" gap="0 32px">\n                    <sw-text-field :disabled="true" :label="$tc(\'klarna-payment-order-management.captureModal.orderAmount\')" :value="klarnaOrder.order_amount | currency(klarnaOrder.currency)"></sw-text-field>\n                    <sw-text-field :disabled="true" :label="$tc(\'klarna-payment-order-management.captureModal.capturedAmount\')" :value="klarnaOrder.captured_amount | currency(klarnaOrder.currency)"></sw-text-field>\n                    <sw-text-field :disabled="true" :label="$tc(\'klarna-payment-order-management.captureModal.remainingAmount\')" :value="klarnaOrder.remaining_amount | currency(klarnaOrder.currency)"></sw-text-field>\n                    <sw-number-field required="required" numberType="float" :digits="2" :label="$tc(\'klarna-payment-order-management.captureModal.captureAmount\')" v-model="captureAmount" :min="minCaptureValue" :max="maxCaptureAmount"></sw-number-field>\n                </sw-container>\n\n                <sw-textarea-field :helpText="$tc(\'klarna-payment-order-management.captureModal.descriptionHelpText\')" v-on:input="onChangeDescription" :label="$tc(\'klarna-payment-order-management.captureModal.labelComment\')" v-model="description"></sw-textarea-field>\n            </div>\n\n            <template slot="modal-footer">\n                <sw-button :disabled="isLoading" @click="closeCaptureModal">\n                    {{ $tc(\'klarna-payment-order-management.captureModal.close\') }}\n                </sw-button>\n\n                <sw-button-process :isLoading="isLoading" :processSuccess="isCaptureSuccessful" @process-finish="onCaptureFinished()" :disabled="isLoading" variant="primary" @click="captureOrder">\n                    {{ $tc(\'klarna-payment-order-management.captureModal.submit\') }}\n                </sw-button-process>\n            </template>\n        </sw-modal>\n    </div>\n{% endblock %}\n',mixins:[j.getByName("notification")],inject:["KlarnaPaymentOrderService"],props:{klarnaOrder:{type:Object,required:!0}},data:function(){return{isLoading:!1,hasError:!1,showCaptureModal:!1,isCaptureSuccessful:!1,selection:[],captureAmount:0,description:""}},computed:{buttonEnabled:function(){return"ACCEPTED"===this.klarnaOrder.fraud_status&&("CANCELLED"!==this.klarnaOrder.order_status&&!(this.klarnaOrder.remaining_amount<=0))},maxCaptureAmount:function(){return this.klarnaOrder.remaining_amount},minCaptureValue:function(){return.01}},methods:{openCaptureModal:function(){this.showCaptureModal=!0,this.isCaptureSuccessful=!1,this.captureAmount=this.klarnaOrder.remaining_amount,this.description="",this.selection=[]},calculateCaptureAmount:function(){var e=0;this.selection.forEach((function(t){t.selected&&(e+=t.unit_price/100*t.quantity)})),(0===e||e>this.klarnaOrder.remaining_amount)&&(e=this.klarnaOrder.remaining_amount),this.captureAmount=e},closeCaptureModal:function(){this.showCaptureModal=!1},onCaptureFinished:function(){this.isCaptureSuccessful=!1},captureOrder:function(){var e=this;this.isLoading=!0;var t=[];this.selection.forEach((function(n){e.klarnaOrder.order_lines.forEach((function(e){if(e.reference===n.reference&&n.selected&&n.quantity){var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){D(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);a.quantity=n.quantity,a.total_amount=a.unit_price*a.quantity;var r=a.tax_rate/100;a.total_tax_amount=Math.round(a.total_amount/(100+r)*r),t.push(a)}}))}));var n={orderTransactionId:this.klarnaOrder.orderTransactionId,klarna_order_id:this.klarnaOrder.order_id,salesChannel:this.klarnaOrder.salesChannel,captureAmount:this.captureAmount,description:this.description,orderLines:JSON.stringify(t),complete:this.captureAmount===this.maxCaptureAmount};this.KlarnaPaymentOrderService.captureOrder(n).then((function(){e.createNotificationSuccess({title:e.$tc("klarna-payment-order-management.messages.captureSuccessTitle"),message:e.$tc("klarna-payment-order-management.messages.captureSuccessMessage")}),e.isCaptureSuccessful=!0})).catch((function(){e.createNotificationError({title:e.$tc("klarna-payment-order-management.messages.captureErrorTitle"),message:e.$tc("klarna-payment-order-management.messages.captureErrorMessage")}),e.isCaptureSuccessful=!1})).finally((function(){e.isLoading=!1,e.showCaptureModal=!1,e.$emit("reload")}))},onSelectItem:function(e,t){0===this.selection.length&&this._populateSelectionProperty(),this.selection.forEach((function(n){n.reference===e&&(n.selected=t)})),this.calculateCaptureAmount()},onChangeQuantity:function(e,t){0===this.selection.length&&this._populateSelectionProperty(),this.selection.forEach((function(n){n.reference===e&&(n.quantity=t)})),this.calculateCaptureAmount()},onChangeDescription:function(e){e.length>=255?this.description=e.substr(0,255):this.description=e},_populateSelectionProperty:function(){var e=this;this.klarnaOrder.order_lines.forEach((function(t){e.selection.push({quantity:t.quantity-t.captured_quantity,reference:t.reference,unit_price:t.unit_price,selected:!1})}))}}});var K=Shopware.Component,I=Shopware.Utils.format.currency;K.register("klarna-order-items",{template:'{# @var \\KlarnaPayment\\Components\\Client\\Response\\GetOrderResponse klarnaOrder #}\n\n{% block klarna_payment_payment_details %}\n    <div class="klarna-order-items">\n        <sw-data-grid\n          :dataSource="orderItems"\n          :columns="orderItemColumns"\n          :showActions="false"\n          :showSelection="true"\n          v-on:select-item="onSelectItem">\n\n            <template slot="column-reference" slot-scope="{ item, isInlineEdit}">\n                <div v-tooltip="{ message: item.reference, disabled: item.reference.length <= 15 }">\n                    {{ item.reference|truncate(15, true, \'...\') }}\n                </div>\n            </template>\n\n            <template slot="column-product" slot-scope="{ item, isInlineEdit}">\n                <sw-product-variant-info\n                        :variations="item.options">\n                    <div class="sw-order-line-items-grid__item-label">\n                        {{ item.product }}\n                    </div>\n                </sw-product-variant-info>\n            </template>\n\n            <template slot="column-price" slot-scope="{ item, isInlineEdit}">\n                {{ item.price }}\n            </template>\n\n            <template slot="column-amount" slot-scope="{ item, isInlineEdit }">\n                <sw-field\n                  :value="item.amount"\n                  type="number"\n                  :min="0"\n                  :disabled="item.disabled"\n                  :max="item.amount"\n                  slot="inline-edit"\n                  size="small"\n                  placeholder=0\n                  v-on:change="onChangeQuantity($event, item.id)">\n                </sw-field>\n            </template>\n        </sw-data-grid>\n    </div>\n{% endblock %}\n',props:{klarnaOrder:{type:Object,required:!0},mode:{type:String,required:!1}},computed:{orderItems:function(){var e=this,t=[];return this.klarnaOrder.order_lines.forEach((function(n){var a=I(n.total_amount/100,e.klarnaOrder.currency),r=!1,i=n.quantity;"refund"===e.mode&&n.captured_quantity>0&&(i=n.captured_quantity),"capture"===e.mode?i-=n.captured_quantity:"refund"===e.mode&&(i-=n.refunded_quantity),i<=0&&(r=!0),t.push({id:n.reference,reference:n.reference,product:n.name,options:n.options,amount:i,disabled:r,price:a,orderItem:n})})),t},orderItemColumns:function(){return[{property:"reference",label:this.$tc("klarna-payment-order-management.modal.columns.reference"),rawData:!0},{property:"product",label:this.$tc("klarna-payment-order-management.modal.columns.product"),rawData:!0},{property:"amount",label:this.$tc("klarna-payment-order-management.modal.columns.amount"),rawData:!0},{property:"price",label:this.$tc("klarna-payment-order-management.modal.columns.price"),rawData:!0}]}},methods:{onSelectItem:function(e,t,n){this.$emit("select-item",t.id,n)},onChangeQuantity:function(e,t){this.$emit("change-quantity",t,e)}}});n("d/ue");var L=Shopware,B=L.Component,N=L.Mixin;B.register("klarna-payment-authorization",{template:'{% block klarna_payment_authorization %}\n    <sw-container class="klarna-extend-authorization">\n        <sw-text-field :helpText="$tc(\'klarna-payment-order-management.order-details.expiryDateHelpText\')" :suffix="true" :disabled="true" :label="$tc(\'klarna-payment-order-management.order-details.expiryDate\')" :value="klarnaOrder.expiry_date | date({hour: \'2-digit\', minute: \'2-digit\'})">\n            <template slot="suffix">\n                <sw-container v-tooltip="{message: $tc(\'klarna-payment-order-management.tooltips.extendAuthorizationImpossible\'), disabled: !buttonDisabled}" :key="buttonDisabled">\n                    <sw-button :disabled="buttonDisabled" @click="openModal">\n                        {{ $tc(\'klarna-payment-order-management.buttons.extendAuthorization\') }}\n                    </sw-button>\n                </sw-container>\n            </template>\n        </sw-text-field>\n\n        <sw-modal class="klarna-payment-detail--authorization-modal klarna-authorization--modal"\n          v-if="showModal"\n          @modal-close="closeModal"\n          :title="$tc(`klarna-payment-order-management.authorizationModal.title`)">\n\n            <div class="authorization-modal--text">\n                {{ $tc(`klarna-payment-order-management.authorizationModal.content`) }}\n            </div>\n\n            <template slot="modal-footer">\n                <sw-button :disabled="isLoading" @click="closeModal">\n                    {{ $tc(\'klarna-payment-order-management.authorizationModal.close\') }}\n                </sw-button>\n\n                <sw-button-process\n                  class="authorization-modal--action"\n                  variant="primary"\n                  :isLoading="isLoading"\n                  :disabled="isDisabled"\n                  :processSuccess="isSuccessful"\n                  @click="extendAuthorization">\n                    {{ $tc(\'klarna-payment-order-management.authorizationModal.submit\') }}\n                </sw-button-process>\n            </template>\n        </sw-modal>\n    </sw-container>\n{% endblock %}\n',props:{klarnaOrder:{type:Object,required:!0}},inject:["KlarnaPaymentOrderService"],mixins:[N.getByName("notification")],computed:{buttonDisabled:function(){return Date.parse(this.klarnaOrder.expiry_date)<new Date("now")||this.klarnaOrder.remaining_amount<=0||"CANCELLED"===this.klarnaOrder.order_status}},data:function(){return{showModal:!1,isDisabled:!1,isLoading:!1,isSuccessful:!1}},methods:{extendAuthorization:function(){var e=this;this.$emit("subComponentLoading",!0),this.isLoading=!0,this.isDisabled=!0,this.KlarnaPaymentOrderService.extendAuthorization(this.klarnaOrder.order_id).then((function(){e.createNotificationSuccess({title:e.$tc("klarna-payment-order-management.messages.authorizationModal.extendSuccessTitle"),message:e.$tc("klarna-payment-order-management.messages.authorizationModal.extendSuccessMessage")}),e.isSuccessful=!0})).catch((function(){e.createNotificationError({title:e.$tc("klarna-payment-order-management.messages.authorizationModal.extendErrorTitle"),message:e.$tc("klarna-payment-order-management.messages.authorizationModal.extendErrorMessage")}),e.isSuccessful=!1})).finally((function(){e.$emit("subComponentLoading",!1),e.$emit("reload",!0),e.isLoading=!1,e.showModal=!1,e.isDisabled=!1}))},openModal:function(){this.showModal=!0,this.isSuccessful=!1},closeModal:function(){this.showModal=!1}}});n("RZWV");var F=Shopware,q=F.Component,H=F.Mixin;q.register("klarna-order-cancel",{template:'{% block klarna_payment_order_cancel %}\n    <div class="klarna-cancellation">\n        <sw-container v-tooltip="{message: $tc(\'klarna-payment-order-management.tooltips.cancellationImpossible\'), disabled: !isDisabled}" :key="isDisabled">\n            <sw-button :disabled="isDisabled" @click="showModal">\n                {{ $tc(\'klarna-payment-order-management.cancellation.modalButton\') }}\n            </sw-button>\n        </sw-container>\n\n        <sw-modal class="klarna-cancellation--modal" v-if="isModalShown" @modal-close="closeModal" :title="$tc(`klarna-payment-order-management.cancellation.modal.title`)">\n            <div class="klarna-cancellation-modal--text">\n                {{ $tc(`klarna-payment-order-management.cancellation.modal.content`) }}\n            </div>\n\n            <template slot="modal-footer">\n                <sw-button :disabled="isLoading" @click="closeModal">\n                    {{ $tc(\'klarna-payment-order-management.cancellation.modal.close\') }}\n                </sw-button>\n\n                <sw-button-process\n                  class="klarna-cancellation-modal--action"\n                  :isLoading="isLoading"\n                  :processSuccess="isSuccessful"\n                  :disabled="isDisabled"\n                  variant="primary"\n                  @click="cancelPayment">\n                    {{ $tc(\'klarna-payment-order-management.cancellation.modal.submit\') }}\n                </sw-button-process>\n            </template>\n        </sw-modal>\n    </div>\n{% endblock %}\n',props:{klarnaOrder:{type:Object,required:!0}},data:function(){return{isLoading:!1,isSuccessful:!1,isModalShown:!1}},computed:{isDisabled:function(){return!(0===this.klarnaOrder.captured_amount&&"CANCELLED"!==this.klarnaOrder.order_status)}},mixins:[H.getByName("notification")],inject:["KlarnaPaymentOrderService"],methods:{showModal:function(){this.isModalShown=!0,this.isSuccess=!1},closeModal:function(){this.isModalShown=!1},cancelPayment:function(){var e=this;this.$emit("subComponentLoading",!0),this.isDisabled=!0,this.isLoading=!0,this.KlarnaPaymentOrderService.cancelPayment(this.klarnaOrder.orderTransactionId,this.klarnaOrder.order_id,this.klarnaOrder.salesChannel).then((function(){e.createNotificationSuccess({title:e.$tc("klarna-payment-order-management.cancellation.messages.successTitle"),message:e.$tc("klarna-payment-order-management.cancellation.messages.successMessage")}),e.isSuccessful=!0})).catch((function(){e.createNotificationError({title:e.$tc("klarna-payment-order-management.cancellation.messages.failureTitle"),message:e.$tc("klarna-payment-order-management.cancellation.messages.failureMessage")}),e.isSuccessful=!1})).finally((function(){e.$emit("reload"),e.$emit("subComponentLoading",!1),e.isLoading=!1,e.isModalShown=!1}))}}});n("mUCT");function U(e){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U(e)}function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function V(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==U(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!==U(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===U(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Z=Shopware,G=Z.Component,J=Z.Mixin;G.register("klarna-refund-button",{template:'{% block klarna_payment_payment_details %}\n    <div class="klarna-refund-button">\n        <sw-container v-tooltip="{message: $tc(\'klarna-payment-order-management.tooltips.refundImpossible\'), disabled: buttonEnabled}" :key="buttonEnabled">\n            <sw-button :disabled="!buttonEnabled" @click="openRefundModal">\n                {{ $tc(\'klarna-payment-order-management.buttons.refundAmount\') }}\n            </sw-button>\n        </sw-container>\n\n        <sw-modal v-if="showRefundModal" @modal-close="closeRefundModal" :title="$tc(`klarna-payment-order-management.refundModal.title`)" class="klarna-payment-detail--refund-modal">\n            <klarna-order-items\n              :klarnaOrder="klarnaOrder"\n              mode="refund"\n              v-on:select-item="onSelectItem"\n              v-on:change-quantity="onChangeQuantity">\n            </klarna-order-items>\n\n            <div class="klarna-payment-detail--refund-modal--content">\n                <sw-container columns="1fr 1fr" gap="0 32px">\n                    <sw-text-field :disabled="true" :label="$tc(\'klarna-payment-order-management.refundModal.orderAmount\')" :value="klarnaOrder.order_amount | currency(klarnaOrder.currency)"></sw-text-field>\n                    <sw-text-field :disabled="true" :label="$tc(\'klarna-payment-order-management.refundModal.refundedAmount\')" :value="klarnaOrder.refunded_amount | currency(klarnaOrder.currency)"></sw-text-field>\n                    <sw-text-field :disabled="true" :label="$tc(\'klarna-payment-order-management.refundModal.remainingAmount\')" :value="remainingAmount | currency(klarnaOrder.currency)"></sw-text-field>\n                    <sw-number-field required="required" numberType="float" :digits="2" :label="$tc(\'klarna-payment-order-management.refundModal.refundAmount\')" v-model="refundAmount" :min="minRefundValue" :max="maxRefundAmount"></sw-number-field>\n                </sw-container>\n\n                <sw-textarea-field :helpText="$tc(\'klarna-payment-order-management.refundModal.descriptionHelpText\')" v-on:input="onChangeDescription" :label="$tc(\'klarna-payment-order-management.refundModal.labelComment\')" v-model="description"></sw-textarea-field>\n            </div>\n\n            <template slot="modal-footer">\n                <sw-button :disabled="isLoading" @click="closeRefundModal">\n                    {{ $tc(\'klarna-payment-order-management.refundModal.close\') }}\n                </sw-button>\n\n                <sw-button-process :isLoading="isLoading" :processSuccess="isRefundSuccessful" @process-finish="onRefundFinished()" :disabled="isLoading" variant="primary" @click="refundOrder">\n                    {{ $tc(\'klarna-payment-order-management.refundModal.submit\') }}\n                </sw-button-process>\n            </template>\n        </sw-modal>\n    </div>\n{% endblock %}\n',mixins:[J.getByName("notification")],inject:["KlarnaPaymentOrderService"],props:{klarnaOrder:{type:Object,required:!0}},data:function(){return{isLoading:!1,hasError:!1,showRefundModal:!1,isRefundSuccessful:!1,selection:[],refundAmount:0,description:""}},computed:{remainingAmount:function(){return this.klarnaOrder.captured_amount-this.klarnaOrder.refunded_amount},buttonEnabled:function(){return!(this.remainingAmount<=0)&&("CANCELLED"!==this.klarnaOrder.order_status&&!(this.klarnaOrder.captured_amount<=0))},maxRefundAmount:function(){return this.remainingAmount},minRefundValue:function(){return.01}},methods:{openRefundModal:function(){this.showRefundModal=!0,this.isRefundSuccessful=!1,this.refundAmount=this.remainingAmount,this.description="",this.selection=[]},calculateRefundAmount:function(){var e=0;this.selection.forEach((function(t){t.selected&&(e+=t.unit_price/100*t.quantity)})),(0===e||e>this.remainingAmount)&&(e=this.remainingAmount),this.refundAmount=e},closeRefundModal:function(){this.showRefundModal=!1},onRefundFinished:function(){this.isRefundSuccessful=!1},refundOrder:function(){var e=this;this.isLoading=!0;var t=[];this.selection.forEach((function(n){e.klarnaOrder.order_lines.forEach((function(e){if(e.reference===n.reference&&n.selected&&n.quantity>0){var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){V(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);a.quantity=n.quantity,a.total_amount=a.unit_price*a.quantity;var r=a.tax_rate/100;a.total_tax_amount=Math.round(a.total_amount/(100+r)*r),t.push(a)}}))}));var n={orderTransactionId:this.klarnaOrder.orderTransactionId,klarna_order_id:this.klarnaOrder.order_id,salesChannel:this.klarnaOrder.salesChannel,refundAmount:this.refundAmount,description:this.description,orderLines:JSON.stringify(t),complete:this.refundAmount===this.maxRefundAmount};this.KlarnaPaymentOrderService.refundOrder(n).then((function(){e.createNotificationSuccess({title:e.$tc("klarna-payment-order-management.messages.refundSuccessTitle"),message:e.$tc("klarna-payment-order-management.messages.refundSuccessMessage")}),e.isRefundSuccessful=!0})).catch((function(){e.createNotificationError({title:e.$tc("klarna-payment-order-management.messages.refundErrorTitle"),message:e.$tc("klarna-payment-order-management.messages.refundErrorMessage")}),e.isRefundSuccessful=!1})).finally((function(){e.$emit("reload"),e.isLoading=!1,e.showRefundModal=!1}))},onSelectItem:function(e,t){0===this.selection.length&&this._populateSelectionProperty(),this.selection.forEach((function(n){n.reference===e&&(n.selected=t)})),this.calculateRefundAmount()},onChangeQuantity:function(e,t){0===this.selection.length&&this._populateSelectionProperty(),this.selection.forEach((function(n){n.reference===e&&(n.quantity=t)})),this.calculateRefundAmount()},onChangeDescription:function(e){e.length>=255?this.description=e.substr(0,255):this.description=e},_populateSelectionProperty:function(){var e=this;this.klarnaOrder.order_lines.forEach((function(t){var n=t.quantity;t.captured_quantity>0&&(n=t.captured_quantity),e.selection.push({quantity:n-t.refunded_quantity,reference:t.reference,unit_price:t.unit_price,selected:!1})}))}}});n("PPuK");var Q=Shopware,Y=Q.Component,X=Q.Mixin;Y.register("klarna-release-amount",{template:'{% block klarna_payment_amount_authorization %}\n    <sw-container class="klarna-release-amount">\n        <sw-text-field :helpText="$tc(\'klarna-payment-order-management.order-details.remainingAmountHelpText\')"\n                       :suffix="true" :disabled="true"\n                       :label="$tc(\'klarna-payment-order-management.order-details.remainingAmount\')"\n                       :value="klarnaOrder.remaining_amount | currency(klarnaOrder.currency)">\n            <template slot="suffix">\n                <sw-container v-tooltip="{message: $tc(\'klarna-payment-order-management.tooltips.releaseAmountImpossible\'), disabled: !buttonDisabled}" :key="buttonDisabled">\n                    <sw-button :disabled="buttonDisabled" @click="openModal">\n                        {{ $tc(\'klarna-payment-order-management.buttons.releaseAmount\') }}\n                    </sw-button>\n                </sw-container>\n            </template>\n        </sw-text-field>\n\n        <sw-modal class="klarna-release-amount--modal"\n          v-if="isModalShown"\n          @modal-close="closeModal"\n          :title="$tc(`klarna-payment-order-management.release.modal.title`)">\n\n            <div class="klarna-release-amount-modal--content">\n                {{ $tc(\'klarna-payment-order-management.release.modal.content\') }}\n            </div>\n\n            <template slot="modal-footer">\n                <sw-button :disabled="isLoading" @click="closeModal">\n                    {{ $tc(\'klarna-payment-order-management.release.modal.close\') }}\n                </sw-button>\n\n                <sw-button-process\n                  class="klarna-release-amount-modal--action"\n                  :disable="isDisabled"\n                  :isLoading="isLoading"\n                  :processSuccess="isSuccessful"\n                  variant="primary"\n                  @click="releaseRemainingAuthorization">\n                    {{ $tc(\'klarna-payment-order-management.release.modal.submit\') }}\n                </sw-button-process>\n            </template>\n        </sw-modal>\n    </sw-container>\n{% endblock %}\n',props:{klarnaOrder:{type:Object,required:!0}},data:function(){return{isLoading:!1,isDisabled:!1,isSuccessful:!1,isModalShown:!1}},mixins:[X.getByName("notification")],inject:["KlarnaPaymentOrderService"],computed:{buttonDisabled:function(){return"CANCELLED"===this.klarnaOrder.order_status||(this.klarnaOrder.remaining_amount<=0||this.klarnaOrder.captured_amount<=0)}},methods:{releaseRemainingAuthorization:function(){var e=this;this.$emit("subComponentLoading",!0),this.isDisabled=!0,this.isLoading=!0,this.KlarnaPaymentOrderService.releaseRemainingAuthorization(this.klarnaOrder.order_id,this.klarnaOrder.salesChannel).then((function(){e.createNotificationSuccess({title:e.$tc("klarna-payment-order-management.release.messages.successTitle"),message:e.$tc("klarna-payment-order-management.release.messages.successMessage")}),e.isSuccessful=!0})).catch((function(){e.createNotificationError({title:e.$tc("klarna-payment-order-management.release.messages.errorTitle"),message:e.$tc("klarna-payment-order-management.release.messages.errorMessage")}),e.isSuccessful=!1})).finally((function(){e.$emit("reload"),e.$emit("subComponentLoading",!1),e.isLoading=!1,e.isModalShown=!1,e.isDisabled=!1}))},openModal:function(){this.isModalShown=!0},closeModal:function(){this.isModalShown=!1}}});n("yYQG");var ee=Shopware,te=ee.Component,ne=ee.Mixin;te.register("klarna-transaction-history",{template:'{% block klarna_payment_payment_details_transaction_history %}\n    <sw-card class="klarna-payment-transactionHistory" :title="$tc(\'klarna-payment-order-management.transactionHistory.title\')">\n        {% block klarna_payment_payment_details_transaction_history_data %}\n            <sw-data-grid\n              :dataSource="translatedHistory"\n              :columns="transactionHistoryColumns"\n              :showActions="true"\n              :showSelection="false">\n\n                {% block klarna_payment_payment_details_transaction_history_data_inner %}\n                    {% block klarna_payment_payment_details_transaction_history_data_status %}\n                        <template slot="column-status" slot-scope="{ item }">\n                            <sw-data-grid-column-boolean v-model="!item.error" :isInlineEdit="false"></sw-data-grid-column-boolean>\n                        </template>\n                    {% endblock %}\n\n                    {% block klarna_payment_payment_details_transaction_history_data_date %}\n                        <template slot="column-date" slot-scope="{ item }">\n                            {{ item.date|date({ hour: \'2-digit\', minute: \'2-digit\' }) }}\n                        </template>\n                    {% endblock %}\n\n                    <template slot="action-modals" slot-scope="{ item }">\n                        {% block klarna_payment_payment_details_transaction_history_modal_button %}\n                            <sw-button size="small" @click="openDetailModal(item)">\n                                {{ $tc(\'klarna-payment-order-management.buttons.showDetails\') }}\n                            </sw-button>\n                        {% endblock %}\n                    </template>\n                {% endblock %}\n            </sw-data-grid>\n        {% endblock %}\n\n        {% block klarna_payment_payment_details_transaction_history_modal %}\n            <sw-modal v-if="showDetailModal" @modal-close="closeDetailModal" :title="detailModalTitle" class="klarna-payment-detail--transaction-modal klarna-request--modal">\n                {% block klarna_payment_payment_details_transaction_history_modal_success %}\n                    <div v-if="success" class="klarna-request klarna-request--success">\n                        <div v-if="orderAmount" class="klarna-request--amount">\n                            <sw-data-grid\n                              :dataSource="orderAmount"\n                              :columns="detailHistoryAmountColumns"\n                              :showActions="false"\n                              :showSelection="false">\n\n                                <template slot="column-type" slot-scope="{ item }">\n                                    {{ $tc(\'klarna-payment-order-management.transactionHistory.modal.type.\' + item.type) }}\n                                </template>\n\n                                <template slot="column-value" slot-scope="{ item }">\n                                    {{ item.value|currency(klarnaOrder.currency) }}\n                                </template>\n                            </sw-data-grid>\n                        </div>\n\n                        <div v-else>\n                            {{ $tc(\'klarna-payment-order-management.transactionHistory.modal.noAmount\') }}\n                        </div>\n                    </div>\n                {% endblock %}\n\n                {% block klarna_payment_payment_details_transaction_history_modal_error %}\n                    <div v-else class="klarna-request--failure">\n                        <div v-if="orderAmount" class="klarna-request--amount">\n                            <sw-data-grid\n                              :dataSource="orderAmount"\n                              :columns="detailHistoryAmountColumns"\n                              :showActions="false"\n                              :showSelection="false">\n\n                                <template slot="column-type" slot-scope="{ item }">\n                                    {{ $tc(\'klarna-payment-order-management.transactionHistory.modal.type.\' + item.type) }}\n                                </template>\n\n                                <template slot="column-value" slot-scope="{ item }">\n                                    {{ item.value|currency(klarnaOrder.currency) }}\n                                </template>\n                            </sw-data-grid>\n                        </div>\n\n                        <div v-else>\n                            {{ $tc(\'klarna-payment-order-management.transactionHistory.modal.noAmount\') }}\n                        </div>\n\n                        <div class="klarna-request-failure--order-id">\n                            <span class="text-strong">\n                                {{ $tc(\'klarna-payment-order-management.transactionHistory.modal.klarnaOrderId\') }}\n                            </span>\n\n                            {{ klarnaOrder.order_id }}\n                        </div>\n\n                        <div class="klarna-request-failure--error-code">\n                            <span class="text-strong">{{ $tc(\'klarna-payment-order-management.transactionHistory.modal.klarnaErrorCode\') }}</span>{{ modalResponse.error_code }}\n                        </div>\n\n                        <div class="klarna-request-failure--http-status">\n                            <span class="text-strong">{{ $tc(\'klarna-payment-order-management.transactionHistory.modal.httpStatus\') }}</span>{{ modalHttpStatus }}\n                        </div>\n\n                        <div class="klarna-request-failure--error-messages">\n                            <span class="text-strong">{{ $tc(\'klarna-payment-order-management.transactionHistory.modal.klarnaErrorMessages\') }}</span>\n\n                            <ul>\n                                <li v-for="error_message in modalResponse.error_messages" class="messages-text">\n                                    <span>{{ error_message }}</span>\n                                </li>\n                            </ul>\n                        </div>\n\n                        <div class="klarna-request-failure--correlation-id">\n                            <span class="text-strong">{{ $tc(\'klarna-payment-order-management.transactionHistory.modal.klarnaCorrelationId\') }}</span>{{ modalResponse.correlation_id }}\n                        </div>\n                    </div>\n                {% endblock %}\n\n                {% block klarna_payment_payment_details_transaction_history_request %}\n                    <div class="klarna-request--json">\n                        <sw-button v-if="stringRequest" size="small" @click="toggleRequestVisibility">\n                            <template v-if="isRequestShown">\n                                {{ $tc(\'klarna-payment-order-management.transactionHistory.modal.RequestButton.Shown\') }}\n                            </template>\n\n                            <template v-else>\n                                {{ $tc(\'klarna-payment-order-management.transactionHistory.modal.RequestButton.NotShown\') }}\n                            </template>\n                        </sw-button>\n\n                        <sw-button v-if="stringResponse" size="small" @click="toggleResponseVisibility">\n                            <template v-if="isResponseShown">\n                                {{ $tc(\'klarna-payment-order-management.transactionHistory.modal.ResponseButton.Shown\') }}\n                            </template>\n\n                            <template v-else>\n                                {{ $tc(\'klarna-payment-order-management.transactionHistory.modal.ResponseButton.NotShown\') }}\n                            </template>\n                        </sw-button>\n\n                        <sw-code-editor\n                          v-if="isRequestShown"\n                          v-model="stringRequest"\n                          mode="text"\n                          :editorConfig="editorConfig"\n                          :softWraps="true"\n                          :setFocus="false"\n                        ></sw-code-editor>\n                        <sw-code-editor\n                          v-if="isResponseShown"\n                          v-model="stringResponse"\n                          mode="text"\n                          :editorConfig="editorConfig"\n                          :softWraps="true"\n                          :setFocus="false"\n                        ></sw-code-editor>\n                    </div>\n                {% endblock %}\n\n            </sw-modal>\n        {% endblock %}\n    </sw-card>\n{% endblock %}\n',props:{klarnaHistory:{type:Array,required:!0},klarnaOrder:{type:Object,required:!0}},data:function(){return{isLoading:!0,hasError:!1,showDetailModal:!1,modalRequest:{},modalResponse:{},modalHttpStatus:null,isResponseShown:!1,isRequestShown:!1,stringResponse:"",stringRequest:"",translatedHistory:[]}},watch:{modalRequest:{deep:!0,immediate:!0,handler:function(){null!==this.modalRequest&&(this.orderAmount=[{type:"total",value:this.klarnaOrder.order_amount}],this.modalRequest.captured_amount&&this.orderAmount.push({type:"captured",value:this.modalRequest.captured_amount/100}),this.modalRequest.refunded_amount&&this.orderAmount.push({type:"refunded",value:this.modalRequest.refunded_amount/100}))}},klarnaHistory:{deep:!0,immediate:!0,handler:function(){var e=this,t="klarna-payment-order-management.transactionHistory.messages.";this.translatedHistory=[],this.klarnaHistory.forEach((function(n){var a=t+n.message,r=e.$tc(a),i=Object.assign({},n);i.message=r===a?"".concat(e.$tc("".concat(t,"Fallback"))," (").concat(n.message,")"):r,e.translatedHistory.push(i)}))}}},inject:["KlarnaPaymentOrderService"],mixins:[ne.getByName("notification")],computed:{editorConfig:function(){return{readOnly:!0}},transactionHistoryColumns:function(){return[{property:"status",label:this.$tc("klarna-payment-order-management.transactionHistory.columns.status"),rawData:!0},{property:"date",label:this.$tc("klarna-payment-order-management.transactionHistory.columns.date"),rawData:!0},{property:"message",label:this.$tc("klarna-payment-order-management.transactionHistory.columns.message"),rawData:!0}]},detailHistoryAmountColumns:function(){return[{property:"type",label:this.$tc("klarna-payment-order-management.transactionHistory.modal.typeColumn"),rawData:"true"},{property:"value",label:this.$tc("klarna-payment-order-management.transactionHistory.modal.valueColumn"),rawData:"true"}]}},methods:{openDetailModal:function(e){var t=JSON.parse(e.response),n=JSON.parse(e.request);this.showDetailModal=!0,this.success=!e.error,this.detailModalTitle="".concat(this.$tc("klarna-payment-order-management.detailModal.title")," - ").concat(e.message),this.modalRequest=n,this.modalResponse=t,this.modalHttpStatus=e.statusCode?e.statusCode:null,0!==Object.keys(t).length&&t.constructor===Object&&(this.stringResponse=JSON.stringify(t,null,2).trimLeft()),0!==Object.keys(n).length&&n.constructor===Object&&(this.stringRequest=JSON.stringify(n,null,2).trimLeft())},closeDetailModal:function(){this.showDetailModal=!1,this.modalRequest=null,this.modalResponse=null,this.stringResponse="",this.stringRequest="",this.isRequestShown=!1,this.isResponseShown=!1},toggleResponseVisibility:function(){this.isResponseShown=!this.isResponseShown,this.isRequestShown=!1},toggleRequestVisibility:function(){this.isRequestShown=!this.isRequestShown,this.isResponseShown=!1}}});var ae=n("Eqvc"),re=n("zRiW");Shopware.Module.register("klarna-payment-order-management",{type:"plugin",name:"KlarnaPayment",title:"klarna-payment-order-management.general.title",description:"klarna-payment-order-management.general.descriptionTextModule",version:"1.0.0",targetVersion:"1.0.0",snippets:{"de-DE":ae,"en-GB":re},routeMiddleware:function(e,t){"sw.order.detail"===t.name&&t.children.push({component:"klarna-payment-tab",name:"klarna-payment-order-management.payment.detail",isChildren:!0,meta:{parentPath:"sw.order.index"},path:"/sw/order/detail/:id/klarna/:transaction"}),e(t)}});n("z5Kc"),n("vOnx")},gIkN:function(e,t,n){},hJRR:function(e,t){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==n(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!==n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===n(o)?o:String(o)),r)}var i,o}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=l(e);if(t){var r=l(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return s(this,n)}}function s(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var c=Shopware.Application,u=Shopware.Classes.ApiService,d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(c,e);var t,n,s,l=o(c);function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"klarna_payment";return a(this,c),l.call(this,e,t,n)}return t=c,(n=[{key:"updateOrder",value:function(e,t){return this.httpClient.post("_action/".concat(this.getApiBasePath(),"/update_order"),{orderId:e},{headers:this.getBasicHeaders(c.getVersionHeader(t))}).then((function(e){return u.handleResponse(e)}))}}])&&r(t.prototype,n),s&&r(t,s),Object.defineProperty(t,"prototype",{writable:!1}),c}(u);c.addServiceProvider("KlarnaPaymentOrderUpdateService",(function(e){var t=c.getContainer("init");return new d(t.httpClient,e.loginService)}))},itAd:function(e,t,n){var a=n("4yaB");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n("SZ7m").default)("14a13d08",a,!0,{})},izwZ:function(e,t,n){},jgmv:function(e,t){var n=Shopware.Component,a=Shopware.Data.Criteria;n.extend("klarna-select-salutation","sw-entity-single-select",{props:{criteria:{type:Object,required:!1,default:function(){return new a(1,100)}}}})},k2fQ:function(e,t,n){},mUCT:function(e,t,n){var a=n("yvCE");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n("SZ7m").default)("6214532c",a,!0,{})},vOnx:function(e,t){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,a){return(t=function(e){var t=function(e,t){if("object"!==n(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!==n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===n(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}Shopware.Component.override("sw-form-field-renderer",{computed:{optionTranslations:function(){var e=this;if(["klarna-select-salutation","klarna-select-payment-codes","klarna-select-delivery-state","klarna-select-order-state"].includes(this.componentName)){if(!this.config.hasOwnProperty("options"))return{};var t=[],n="label";return this.config.hasOwnProperty("labelProperty")&&(n=this.config.labelProperty),this.config.options.forEach((function(a){var i=e.getTranslations("options",a,[n]),o=r(r({},a),i);t.push(o)})),{options:t}}return this.$super("optionTranslations")}}})},w4jL:function(e){e.exports=JSON.parse('{"klarna-payment-configuration":{"module":{"title":"Klarna.","description":"Klarna."},"settingsForm":{"title":"Klarna","inheritanceWarning":"Die Darstellung der Vererbung für die Plugin-Konfiguration wurde mit Shopware 6.3.4.0 optimiert. Bitte aktualisieren Sie Ihr System, wenn Sie die Vererbung sicher verwenden möchten.","apiConfiguration":{"notice":"Bitte beachten Sie, dass der Test- und Debug-Modus nicht individuell pro Region konfiguriert werden kann, da der entsprechende Endpunkt anhand der Rechnungsadresse gewählt wird."},"globalPurchaseMissingInfo":"Sofort bezahlen, Pay Later und Ratenkauf werden zu einer einzigen Zahlungsmethode zusammengefasst: Bezahlen mit Klarna. Jeder Klarna-Kunde wird in Kürze automatisch auf diese neue Zahlungsmethode migriert. Der Status Ihrer Migration wird jedes Mal überprüft, wenn ein Kunde die Seite zur Bestellbestätigung aufruft. Diese Meldung verschwindet automatisch, sobald Sie migriert sind","deprecatedConfiguration":"Sofort bezahlen, Pay Later und Ratenkauf sind jetzt in einer Zahlungsmethode kombiniert: Bezahlen mit Klarna. Diese Konfiguration wird nicht mehr benötigt und wird in einer zukünftigen Version entfernt.","messages":{"titleSuccess":"Erfolg","titleError":"Fehler","messageTestEUSuccess":"Die API-Zugangsdaten für Europa wurden erfolgreich validiert.","messageTestUSSuccess":"Die API-Zugangsdaten für Nordamerika wurden erfolgreich validiert.","messageTestEUErrorLive":"Die API-Zugangsdaten für Europa konnten nicht validiert werden.","messageTestEUErrorTest":"Die API-Zugangsdaten für Europa des Testmodus konnten nicht validiert werden.","messageTestUSErrorLive":"Die API-Zugangsdaten für Nordamerika konnten nicht validiert werden.","messageTestUSErrorTest":"Die API-Zugangsdaten für Nordamerika des Testmodus konnten nicht validiert werden.","messageSaveSuccess":"Die Plugin-Einstellungen wurden gespeichert.","messageSaveError":"Die Plugin-Einstellungen konnten nicht gespeichert werden.","messageMissingApiUsername":"Für den aktiven Modus wurde kein Wert für die Option \\"Api-Benutzername\\" angegeben!","messageMissingApiPassword":"Für den aktiven Modus wurde kein Wert für die Option \\"Api-Password\\" angegeben!"},"buttons":{"save":"Einstellungen speichern","test":"API-Zugangsdaten testen","wizard":"Wizard starten"},"onsiteMessaging":{"generate":"Generiere deine Daten hier","playgroundUrl":"https://playground.eu.portal.klarna.com/on-site-messaging/#realm=merchants","defaultUrl":"https://eu.portal.klarna.com/on-site-messaging/#realm=merchants"},"klarnaPayments":{"payLater":{"description":"Die Option \\"Rechnung\\" macht Kunden den Bezahlvorgang einfach und schnell, ohne dabei persönliche Daten oder komplizierte Nummern eingeben zu müssen. Der Kunde hat die Wahl zwischen Rechnung und im Monat X bezahlen.","title":"Pay Later"},"sliceIt":{"description":"Mittels \\"Ratenkauf\\" können Kunden die Einkaufssumme bei geringen Zinsen in Häppchen aufteilen. Das erhöht den Investitionsrahmen und die Kaufkraft. Klarna\'s einzigartige Kreditbearbeitung erfordert nur wenige Augenblicke und minimale Dateneingabe. Der Kunde hat die Wahl zwischen fixen und flexiblen Raten.","title":"Ratenkauf"},"payNow":{"additional":"Für \\"Sofort bezahlen\\" müssen sowohl die kombinierte Zahlungsmethode \\"Sofort bezahlen\\" als auch die einzelnen Zahlungsmethoden \\"Kreditkarte\\", \\"Lastschrift\\" und \\"Sofortüberweisung\\" zu den Verkaufskanälen hinzugefügt werden.","description":"Kunden, die Beträge sofort vollständig beim Bestellabschluss bezahlen möchten, können die Option \\"Sofort bezahlen\\" nutzen. Zur Auswahl stehen hierbei Kreditkarte, Lastschrift und die Sofortüberweisung.","title":"Sofort bezahlen"}}},"wizard":{"title":"Wizard","klarnaProduct":"Genutztes Klarna Produkt","steps":{"welcome":"Willkommen","salesChannel":"Verkaufskanal","documentation":"Dokumentation"},"content":{"welcome":{"customer":"Sind Sie bereits Klarna Händler? Klicken Sie bitte auf Weiter.","registration":"Sofern Sie noch keine Registrierung bei Klarna vorgenommen haben, wenden Sie sich bitte per email an&nbsp;<a href=\'mailto:vertrieb@klarna.com\'>vertrieb@klarna.com</a>.","installation":"Für die Einrichtung und Verwendung des Plugins finden Sie die Installationsanleitung&nbsp;<a href=\'https://bit.ly/klarna-shopware-6-installationguide-de\'>HIER</a>."},"documentation":{"headline":"Vielen Dank. Die Konfiguration von Klarna ist abgeschlossen.","introduction":"Egal was Sie verkaufen, unsere Produkte sind dafür gemacht, Ihren Kunden das Beste und Ihnen das zufriedenste Kundenerlebnis zu bereiten. Wir unterstützen Sie online dabei, eine große Auswahl an Zahlungsmöglichkeiten anzubieten.","conclusion":"Um mehr über Klarna zu erfahren, klicken Sie bitte&nbsp;<a href=\'https://bit.ly/klarna-shopware-6-installationguide-de\'>HIER</a>."}},"type":{"deactivated":"Deaktiviert","payments":"Klarna Payments","checkout":"Klarna Checkout"},"action":{"back":"Zurück","next":"Weiter","finish":"Fertig"},"messages":{"titleSuccess":"Erfolg","titleError":"Fehler","messageLoadError":"Der Wizard konnte nicht geladen werden.","messageSaveSuccess":"Die Einrichtung wurde erfolgreich abgeschlossen.","messageSaveError":"Die Einrichtung konnte nicht erfolgreich abgeschlossen werden."}}}}')},yKc4:function(e,t,n){var a=n("izwZ");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n("SZ7m").default)("0e3c7705",a,!0,{})},yYQG:function(e,t,n){var a=n("gIkN");a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n("SZ7m").default)("d0f67828",a,!0,{})},yvCE:function(e,t,n){},z5Kc:function(e,t){Shopware.Component.override("sw-system-config",{computed:{typesWithMapInheritanceSupport:function(){var e=this.$super("typesWithMapInheritanceSupport");return"KlarnaPayment.settings"===this.domain&&(e.push("single-select"),e.push("multi-select")),e}},methods:{onSalesChannelChanged:function(e){this.$super("onSalesChannelChanged",e),this.$emit("saleschannel-changed",this.currentSalesChannelId)},hasMapInheritanceSupport:function(e){var t=e.config?e.config.componentName:void 0;return!!["klarna-select-salutation","klarna-select-delivery-state","klarna-select-order-state","klarna-select-payment-codes"].includes(t)||this.$super("hasMapInheritanceSupport",e)}}})},zRiW:function(e){e.exports=JSON.parse('{"klarna-payment-order-management":{"order-details":{"title":"Order details","orderNumber":"Shopware Order Number","orderAmount":"Order Total Amount","capturedAmount":"Captured Amount","refundedAmount":"Refunded Amount","remainingAmount":"Remaining Authorized Amount","remainingAmountHelpText":"The remaining authorized amount can be captured if needed.","klarnaOrderId":"Klarna Order ID","klarnaReference":"Klarna Reference","klarnaStatus":"Klarna Order Status","initialPaymentMethod":"Initial payment method","riskCheck":"Klarna Fraud Status","riskCheckHelpText":"Only transactions with status ACCEPTED can be captured","expiryDate":"Expiry Date","expiryDateHelpText":"If the expiry date is exceeded, no further action is possible on the transaction."},"order-tab":{"title":"Klarna."},"modal":{"columns":{"reference":"Product number","product":"Product","amount":"Amount","price":"Price"}},"tooltips":{"transactionCancelled":"The transaction was cancelled.","captureImpossible":"A capture can only be performed if the risk assessment was successful and authorized amount is available.","refundImpossible":"A refund can only be made if an amount has been captured.","extendAuthorizationImpossible":"The authorization has already expired or was captured and can therefore not be renewed.","releaseAmountImpossible":"There is no authorized amount left or the full amount has been captured.","cancellationImpossible":"The payment can only be cancelled if no amount has been captured yet."},"captureModal":{"title":"Capture amount","submit":"Capture amount","close":"Cancel","labelComment":"Comment","orderAmount":"Total authorized amount","capturedAmount":"Amount already captured","remainingAmount":"Remaining authorized amount","captureAmount":"Capture amount","descriptionHelpText":"The comment is currently not visible in the Klarna Merchant Portal."},"refundModal":{"title":"Refund amount","submit":"Refund amount","close":"Cancel","labelComment":"Comment","orderAmount":"Total authorized amount","refundedAmount":"Amount already refunded","remainingAmount":"Remaining refundable amount","refundAmount":"Refund amount","descriptionHelpText":"The comment is currently not visible in the Klarna Merchant Portal."},"detailModal":{"title":"Details"},"authorizationModal":{"title":"Extend authorization","content":"Do you really want to extend the authorization?","submit":"Yes, extend","close":"Cancel"},"transactionHistory":{"title":"Order history","columns":{"status":"Status","date":"Time","message":"Message"},"messages":{"CancelOrder":"Order cancelled","CancelPayment":"Cancelled payment","GetOrder":"Order requested","CreateCapture":"Capture created","CreateOrder":"Order placed","CreateRefund":"Refund created","ExtendAuthorization":"Authorization extended","Fallback":"Unknown request","ReleaseRemainingAuthorization":"Remaining amount released","UpdateAddress":"Address updated","UpdateOrder":"Order updated"},"modal":{"typeColumn":"Amount","valueColumn":"Value","noAmount":"No further information","httpStatus":"HTTP Status Code:","type":{"total":"Order Transaction Total Amount","captured":"Captured Amount in this action","refunded":"Refunded Amount in this action"},"klarnaOrderId":"Klarna Order Id:","klarnaErrorCode":"Klarna Error Code:","klarnaErrorMessages":"Error Messages:","klarnaCorrelationId":"Klarna Correlation Id:","ResponseButton":{"Shown":"Hide response","NotShown":"Show response"},"RequestButton":{"Shown":"Hide request","NotShown":"Show request"}}},"cancellation":{"messages":{"successTitle":"Success","successMessage":"The payment was successfully cancelled.","failureTitle":"Failure","failureMessage":"The payment could not be cancelled."},"modalButton":"Cancel payment","modal":{"title":"Payment cancellation","content":"Do you really want to cancel the payment?","submit":"Yes, cancel the payment","close":"Cancel"}},"release":{"messages":{"successTitle":"Success","successMessage":"The remaining authorization amount was successfully released.","errorTitle":"Error","errorMessage":"The remaining authorization amount could not be released."},"modal":{"title":"Release authorization amount","content":"Do you really want to release the remaining authorization amount?","submit":"Yes, release","close":"Cancel"}},"buttons":{"captureAmount":"Capture amount","refundAmount":"Refund amount","cancelOrder":"Cancel payment","extendAuthorization":"Extend authorization","releaseAmount":"Release amount","showDetails":"Details"},"messages":{"authorizationModal":{"extendSuccessTitle":"Success","extendSuccessMessage":"The Klarna authorization was successfully extended.","extendErrorTitle":"Error","extendErrorMessage":"The Klarna authorization could not be extended."},"loadErrorTitle":"Error","loadErrorMessage":"Klarna order details could not be loaded.","captureErrorTitle":"Error","captureErrorMessage":"Capture could not be performed successfully.","captureSuccessTitle":"Success","captureSuccessMessage":"Capture successfully completed.","refundErrorTitle":"Error","refundErrorMessage":"Refund could not be performed successfully.","refundSuccessTitle":"Success","refundSuccessMessage":"Refund successfully completed.","updateErrorTitle":"Error","updateErrorMessage":"Klarna does not approve the order change."}}}')}});
//# sourceMappingURL=klarna-payment.js.map